(()=>{function e(e,t=ae.weaponType()){const n=window.thisKey;let a=window.selectedSkills;const l=e||structuredClone(n[t].weapons[le("dropWeapon")]),s=10===l.rank&&document.getElementById("augUpgrades").checked;if(/BowGun/.test(t)&&("LightBowGun"===t&&"Long"===document.getElementById("BowgunBarrel").selectedOptions[0].text&&(l.baseRaw=~~(l.baseRaw*(a["Tune-Up"]<2?1.05:1.075))),"HeavyBowGun"===t&&"Power"===document.getElementById("BowgunBarrel").selectedOptions[0].text&&(l.baseRaw*=a["Tune-Up"]<2?1.125:1.15,l.baseRaw=~~l.baseRaw),s&&(l.baseRaw+="HeavyBowGun"===t?20:10)),"Bow"===t&&s&&(l.baseRaw+=15),!t.includes("Bow")&&s&&document.getElementById("augUpgrades").checked)if(/Water|Ice|Thunder|Fire|Dragon/.test(l.eleType))switch(l.baseRaw+=25,t){case"GreatSword":case"Hammer":l.baseEle+=30;break;case"lance":case"Gunlance":l.baseEle+=21;break;default:l.baseEle+=18}else l.baseRaw+=40;return l.baseRaw+=+document.querySelector("output.attackAug + output").value.slice(-2),l.aff=(l.aff||0)+ +document.querySelector("output.affinityAug + output").value.slice(-2),l.baseAff=l.aff,ae.helpers.isStatusAttack(l)?l.baseEle+=+document.querySelector("output.statusAug + output").value.slice(-2):"None"!==l.eleType&&(l.baseEle+=+document.querySelector("output.elementalAug + output").value.slice(-2)),l}function t(e){if(!e)return;const t=ae.armor(e);n(e,t.qurious,t.qurious);let s=document.querySelectorAll(`.${e} .armorAugment select`);for(let e=0;e<12;e++)s[e].selectedIndex=0;l([e]),a()}function n(e,t,n){let a=document.querySelector(`section.${e} .currentPoints`);a.textContent=a.textContent.replace(/(?=>\s)?\d+(?=[^/]*\/)/,t).replace(/(?<=\/)\d+/,n)}function a(){let e=ae.statsByValue("Dragonheart").Resist,t=e||ae.statsByValue("Furious").Resist+ae.statsByValue("DragonConversion").Resist+ae.statsByValue("DefenseBoost").Resist;const n={};for(let a of re)n[a]=e||ae.statsByValue(`${a}Resistance`).Resist+ +ae.elValue(`${a}Res`)+t;for(let t of ae.armorTypes()){let a=ae.armor(t),l=document.querySelector(`.${t}`);for(let t=0;t<5;t++)l.querySelector(`.${ce.swapFirstLetterCase(re[t])} output`).textContent=a.def[t+1],e||(n[re[t]]+=+a.def[t+1])}for(let e=0;e<5;e++)document.querySelector(`#weapon .${ce.swapFirstLetterCase(re[e])} output`).textContent=Math.min(50,n[re[e]]);!function(){let e=0;for(let t of ae.armorTypes()){let n=ae.armor(t).def[0];document.querySelectorAll(`#${t}Qurious .augmentType`).forEach((e=>{1===e.selectedIndex&&(n-=[0,6,12][Math.max(0,+e.nextElementSibling.selectedIndex)])})),document.querySelector(`section.${t} .def output`).textContent=n,e+=+n}document.querySelector("#weapon .def output").textContent=e}()}function l(e=ae.armorTypes()){Object.values(e).forEach((e=>{if(""===e)return;const t=ae.armor(e),n={...t.skills},a=ae.$$(`#${e}Qurious select.augmentType`);let l=[0,0,0],i=4,c=0;for(;c<3&&i--;){let e=t.decos[i];for(;e--;)l[c]=i+1,++c}for(let e of a){let t=e.nextElementSibling;if(!(t.selectedIndex<=0||e.selectedIndex<=0))if(2===e.selectedIndex||4===e.selectedIndex){const a=oe.skills.removeFormatting(t.selectedOptions[0].textContent,"id");n[a]?n[a]+=e.selectedIndex-3:n[a]=1}else 3===e.selectedIndex&&(l=s(l,t.selectedIndex))}for(let n of ae.$$(`section.${e}.eleDiv`))n.children[1].textContent=t[n.classList[0]];o(e,n),r(e,l)}))}function s(e,t){for(let n=0;n<3&&t>0;++n)0===e[n]&&(++e[n],--t);for(let n=0;n<3&&t>0;++n)for(;e[n]<4&&t;)++e[n],--t;return e}function o(e,t){const n=Object.entries(t),a=document.querySelectorAll(`section.${e} .skillDiv>output`);[2,3,4,0,1].forEach(((e,t)=>{const l=a[e];if(!n[t])return l.textContent="",void l.nextElementSibling.classList.add("augInvis");let s=n[t];s[0]=oe.skills[s[0]].name,l.textContent=`${oe.skills.formatName(s[0])} +${s[1]}`,l.nextElementSibling.classList.remove("augInvis")}))}function r(e,t){const[n,a]=ae.el.decoImages[e];for(let e=0;e<t.length;e++){let l=n[e],s=a[e],o=Math.min(4,t[e]);if(s.childElementCount>5&&l.classList.contains(`lvl${o}`))continue;if(l.className=l.className.replace(/(?<=lvl)\d/,o),l.src=l.src.replace(/lvl\d/,`lvl${o}`),!o){s.selectedIndex=0,s.innerHTML="";continue}let r=['<option value="0"> ---- </option>','<option class="optTitle" value="1" disabled>lvl-1 Decos</option>','<option class="optTitle" value="2" disabled>lvl-2 Decos</option>','<option class="optTitle" value="3" disabled>lvl-3 Decos</option>','<option class="optTitle" value="4" disabled>lvl-4 Decos</option>'],i=Object.values(oe.skills),c=i.length;for(let e=(c>>1)-1;e<c;++e){const{decos:t,name:n}=i[e];if(t&&t[0]<=o){let e=oe.skills.formatName(n),a=0;for(let n=t[0];n<=o;++n)t[n]!==a&&(a=t[n],r[n]+=`<option value="${n}">${e} +${t[n]}`)}}let d=r[0];for(;o;)d+=r[o--];s.innerHTML=d}}function i(e,t,n=!1){!n&&performance.now()-se.time?.augments<100?se.time.augments=performance.now():(se.time.augments=performance.now(),isFinite(t)||t&&!t.includes("---")||(t=""),d(e.previousElementSibling.selectedIndex,e,e.parentElement.parentElement.id.split("Qurious")[0],t),c(e.parentElement.parentElement.id.split("Qurious")[0]))}function c(e){const t=ae.armor(e);let a={...t.skills};const s=document.querySelectorAll(`.${e} .augment`),o=document.querySelectorAll(`.${e} .augmentType`);let r=t.qurious,i=-1;for(;++i<6;){const e=o[i],t=s[i];t&&("-Skill"===e.value&&--a[ie(t.textContent)]<0?(t.selectedIndex=0,e.selectedIndex=0):r+=+t.value)}for(;r<0&&i--;)+s[i].value<0&&(r-=+s[i].value,s[i].selectedIndex=0,o[i].selectedIndex=0);return l([e]),n(e,r,t.qurious),r}function d(e,t,n="",a=""){let l=+document.querySelector(`section.${n} .currentPoints`).textContent.match(/\d+(?=\/)/)[0];if(isFinite(+t.value)&&(l-=+t.value),e%2)return t.innerHTML=3===e?ce.slotAug(Math.min(3,~~(l/6))):ce.defAug(),a&&(t.selectedIndex=a),void c(n);const s=ae.armor(n).skills;a&&(a=a>=0&&a<250?oe.skills[a].name:ie(a));let o=0,r=0,i=ae.$$(`section.${n} .skillDiv>output`),d=[];for(let e of i)e.textContent&&d.push({name:ie(e.textContent),id:oe.skills[ie(e.textContent)].id,level:+e.textContent.match(/\d+/)[0]});let u='<option value="0"> ---- </option>';if(2===e)d.forEach((e=>{s[e.id]&&(e.name===a||e.level>0)&&(++r,u+=`<option value="+10">${oe.skills.formatName(e.name)} +10Pts</option>`,e.name===a&&(o=r))}));else{let e=[];if(5===d.length){oe.skills[a].id;for(let t of d){let{qurious:n,name:a}=oe.skills[t.name];!n||n>l||e.push([a,n])}}else{const t=Object.values(oe.skills);for(let n=0;n<147;n++){const{name:a,qurious:s}=t[n];!s||s>l||e.push([oe.skills.formatName(a),s])}}for(let t of e)u+=`<option value="-${t[1]}">${t[0]} -${t[1]}Pts</option>`,++r,ie(t[0])===a&&(o=r)}t.innerHTML=u,a&&o>0&&(t.selectedIndex=o),c(n)}function u(e,t=!1){if(performance.now()-de.time.quest<100&&!t)return;const n=ae.mon(e);de.time.quest=performance.now(),function(e){const t=ae.weaponType().includes("Bow")?"shot":"H"===ae.weaponType()[0]?"blunt":"sever",{eleType:n}=ae.weapon(),a=ue.indexOf(t),l=ue.indexOf(n),s=ae.mon(e).parts.sort(((e,t)=>t[a]-e[a]||t[l]-e[l]));let o="";s.forEach((e=>{o+=`<option>${e[0]}`})),ce.innerHTML(ae.el.part,o),ce.innerHTML(ae.el.part2,o)}(n.name),p(n.name),g(n.name),m()}function m(e=ae.mon()){if(function(e){let t="",n=ae.quest();n&&n.mons[e.em]||(p(e.em),n=ae.quest()),n&&(e.spawn[n.map][n.mons[e.em][0]].forEach((e=>{t+=`<output>Spawn Area ${e[1]} ${e[0]}%</output>`})),document.getElementById("spawnArea").innerHTML=t)}(e),""===ae.el.quest.value)return;const t=document.getElementById("tBody");let n="";e.parts.forEach((e=>{n+=`<section><label>${e[0]}</label>`;for(let t=1;t<9;++t){let a=e[t];a=document.getElementById("WaterBlight").checked&&t<4?~~Math.min(100,~~(Math.max(a,.63*a+22.2)+3)):+a,n+=`<div class="${a<14?"F":a<15?"C":a<45?"B":a<65?"A":"S"}">${a}</div>`}n+="</section>"})),t.innerHTML=n}function p(e){let t=ae.mon(e).em,n={HR:"",MR:""},a=!0,l=ae.quests();for(let e=0;e<l.length;e++){let s=l[e];s.mons[t]&&(a=!1,n[s.rank]+=`<option value="${e}">${s.quest}`)}if(a)return;let s=document.getElementById("HR"),o=document.getElementById("MR");o.innerHTML=n.MR,s.innerHTML=n.HR,f(o.childElementCount?o.options[0]:s.options[0]),o.classList.toggle("augInvis",o.childElementCount),s.classList.toggle("augInvis",s.childElementCount)}function g(e){const t=ae.mon(e).em;if("undefined"===ae.el.quest.value)return;let n=ae.elSelectedIndex("players"),a=Math.min(2,1+.35*n),l=ae.quest().mons[t],s="";for(let e=1;e<l.length;e++)s+="<option>"+l[e]*a;ae.el.health.innerHTML=s,ae.el.health.selectedIndex=0}function f(e){ae.el.quest.options[0].value=e.value,ae.el.quest.options[0].textContent=e.textContent,ce.addClass("questDiv","augInvis")}function h(e,t,n){return+e[t].textContent.at(-1)!==n&&(e[t].textContent=e[t].textContent.slice(0,-1)+n),`${e[t-1].outerHTML} ${e[t].outerHTML}`}function w(e,t,n){let a=e[t-1].textContent.slice(-1),l=pe[Math.min(3,n)],s=a>=0?Math.max(0,n-a):l.length-1;return e[t].textContent=e[t].textContent.slice(0,-1)+n,`<button type="button" aria-pressed="false" data-state="${s}" onClick="let states = ${JSON.stringify(l).replace(/"/g,"'")}; let index = (+this.dataset.state + 1) % ${l.length}; this.textContent = states[index]; this.dataset.state = index;">${l[s]}</button>${e[t].outerHTML}`}function y(e,t){const n=ae.elValue("dropWeaponType").includes("BowGun"),a=!document.getElementById("ammoTable").classList.contains("augInvis")&&n,l=document.getElementById("dpsTable").classList.contains("augInvis")||!n,s=ae.$$("#dpsTable tr.tableRowMelee").map((e=>e.children));let o="ChargeBlade"!==ae.weaponType()||window.thisKey.ChargeBlade.weapons[ae.elValue("previousWeapon")]?.phialType===window.thisKey.ChargeBlade.weapons[ae.el.weapon.value].phialType;if(s.length&&ae.elValue("previousWeaponType")===ae.weaponType()&&o&&(ae.elValue("previousWeapon")===ae.el.weapon.value||"Bow"!==ae.weaponType())&&"BowChargePlus"!==window.event.target.id)!function(e,t,n){let a=n?1:2;for(let n=0;n<t.length;++n)for(let l=a;l<t[n].length;l++)t[n][l].textContent=e[n+1][l]}(e,s,n);else{const s=document.querySelector(`#${t}Body`),o=document.createElement("tbody");o.id=`${t}Body`;const r=e.splice(0,1),i=document.querySelector(`#${t}Head`);i.className=n?"tableRowRanged":"tableRowMelee",i.id=`${t}Head`;let c="";r[0].forEach((e=>{c+=Array.isArray(e)?`<label data-tooltip="${e[1]}">${e[0]}</label>`:`<label>${e}</label>`})),i.innerHTML=c;let d=0;for(const t of e){const e=document.createElement("tr");e.className=n?"tableRowRanged":"tableRowMelee";for(let a=0;a<Object.values(t).length;a++){const l=Object.values(t)[a];let s=document.createElement(n&&0===a?"label":"div");if(n||a>1)s.textContent=l;else if(a)s.innerHTML=`<button type="button" aria-pressed="false" id="${d}" class="inputButton dec"\n                      >&#8681</button><button type="button" aria-pressed="false" id="${d}" class="inputButton inc"\n                      >&#8679</button><output class="label">${l}</output>`,s.id=`b${d}`,s.className=`b ${d} inputContainer`;else{const e=document.createElement("input");e.type="number",e.max="20",e.ariaLabel=d?"Add Skill To Combo":"Combo Repeat All",e.className=0===d?`inputComboRepeat a ${d} inputs`:`hitsOfSharpInputs a ${d} inputs`,e.min=d?"0":"1",e.value=d?"0":"1",s.appendChild(e),s.className=`a ${d}`}e.appendChild(s)}o.appendChild(e),d++}s.replaceWith(o),o.className=n?"rangedTable":"meleeTable",document.getElementById("damageContainer").className=n?"rangedContainer":"meleeContainer",document.getElementById("ammoTable").classList.toggle("augInvis",a),document.getElementById("dpsTable").classList.toggle("augInvis",!l),n||document.getElementById("ammoTable").classList.add("augInvis"),ce.elValue("previousWeapon",ae.el.weapon.value),ce.elValue("previousWeaponType",ae.weaponType())}n||document.querySelectorAll(".inputs").forEach((e=>{const t=document.getElementById("filterTable").classList.contains("selected")&&0==e.value;e.parentElement.parentElement.classList.toggle("augInvis",t)}))}function E(){const t=[],n=e(),a=[...n.decos];let l=2;for(let e=3;e>=0&&l;e--)for(;a[e]>0;)t.push(e+1),--a[e],--l;if(r("weapon",t),document.querySelectorAll("#weaponRampage>*").forEach((e=>e.classList.add("augInvis"))),document.getElementById("weaponRampage0").classList.remove("augInvis"),n.rampageSlots){const e=Math.min(3,n.rampageSlots+fe.augIndex.rampageAug);document.getElementById("rampImg").src=document.getElementById("rampImg").src.replace(/ramp\d/,`ramp${e}`);let t="";return Object.entries(fe.rampage.rampageDecos).forEach((n=>{+n[0].slice(-1)<=e&&(t+=`<option>${n[1]}`)})),void(document.getElementById("weaponRampage0").innerHTML=t)}document.querySelectorAll("#weaponRampage>*").forEach((e=>{e.selectedIndex=0,e.classList.add("augInvis")})),document.getElementById("weaponRampage0").classList.remove("augInvis"),/Rampage/.test(n.weapon)?fe.rampage[n.weapon].Rampage.forEach(((e,t)=>{document.querySelector("#weaponRampage").children[t].classList.remove("augInvis"),ce.selectText(ae.$(`#weaponRampage *:nth-child(${t+1})`),Object.values(e))})):n.rampage.forEach((e=>{const t=document.createElement("option");t.value=fe.rampage.keys2[e],t.textContent=fe.rampage.keys2[e],document.getElementById("weaponRampage0").append(t)}))}function v(){for(let e of Object.entries(he.augIndex))e[1]>0&&(document.querySelector(`.augLabel.${e[0]}`).textContent=0,document.querySelector(`.augLabel.${e[0]}+ output`).textContent="+0",he.augIndex[e[0]]=0);if(document.getElementById("weaponQurious").textContent="Remaining Augments 10/10",document.getElementById("elementDiv").classList.add("augInvis"),document.getElementById("statusDiv").classList.add("augInvis"),ae.weaponType().includes("BowGun"))return;let t=e();ae.helpers.isStatusAttack(t.eleType)?function(){let e="GreatSword"===ae.weaponType()?[0,3,12,18,24]:/^Bow$|Dual/.test(ae.weaponType())?[0,3,6,9,12]:/Bow/.test(ae.weaponType())?[0,0,0,0,0]:[0,3,8,12,16];document.getElementById("statusDiv").classList.remove("augInvis"),he.augs.statusAug[5]!==e[5]&&he.augs.statusAug.forEach(((t,n)=>t[1]=e[n]))}():"None"!==t.eleType&&function(){let e=/Great|Hammer/.test(ae.weaponType())?[0,5,10,15,20,25,33,43,55]:/Lance/i.test(ae.weaponType())?[0,3,6,10,14,18,24,32,42]:/Bow/.test(ae.weaponType())?[0,0,0,0,0,0,0,0,0]:[0,3,6,9,12,15,20,27,35];document.getElementById("elementDiv").classList.remove("augInvis"),he.augs.elementalAug[8]!==e[8]&&he.augs.elementalAug.forEach(((t,n)=>t[1]=e[n]))}()}function S(){if(""===we||we===document.getElementById("BowCoating")&&"Bow"!==ye.value)return;let t=[];Object.values(we.children).some((e=>"OPTGROUP"===e.tagName))?(t=document.querySelectorAll(`${we.id}>*>*`),t.splice(-2),t.splice(0,0,we[0])):t=Object.values(we.children),t.forEach(((t,n)=>{let a;if(we===document.getElementById("BowCoating"))a=e().coatings[n];else if(we===document.getElementById("BowgunBarrel"))a=["----","Long","Power","Silencer","Guard-Up"][n];else if(we===document.getElementById("Dereliction"))a=["----","Lv-1-1","Lv-1-2","Lv-1-3","Lv-2-1","Lv-2-2","Lv-2-3","Lv-3-1","Lv-3-2","Lv-3-3"][n];else{let e=n;"OPTGROUP"===we.children[1].tagName&&0!==n&&(e="Burst"===we.id&&n>=2?n-1:n%3==0?3:n%3),a="Burst"===we.id&&1===n?"Base Bonus":`Lv-${e}`}t.textContent=0===n?"----":a})),we=""}function B(e){const t=[1.25,6,5.5,11.75];let{allArmors:n,skills:a,skillLevels:l}=e;const s={},o=l[110]-3;return ae.armorTypes().forEach((e=>{let r=[];for(let s=0;s<n[e].length;s++){const i=n[e][s];if(1===i.sex)continue;const c=[],d=[];let u=0,m=0;const p=[],g=[...Object.entries(i.skills)],f=[...i.decos],h=new Uint8Array(9),w=i.decoAugs?[...i.decoAugs]:"";let y=i.qurious;w&&(h[8]-=w.length+1,w.forEach((e=>{++f[e],e&&--f[e-1]})),y-=6*w.length);for(let e=0;e<4;e++)m+=f[e]*t[e];if(o>0)for(let e=0;e<g.length;e++)g[e][1]+=o;if(13!==i.qTable){let e=6;for(let n=0;n<g.length;n++){let[s,o]=[+g[n][0],g[n][1]];p[n]=s;let r=Math.min(o,l[s]||0);if(o-=r,r){c.push(s);let e=a[s];switch(+!e.charm+ +(!e.qurious&&!e.decos)){case 2:m+=50*r;break;case 1:m+=25*r;break;default:m+=r*t[e.decos&&e.decos[0]>0?e.decos[0]-1:1]}}for(;o--;)e<8||!h[8]?(y+=10,h[e++]=s):d[u++]=s}for(let e=6;e<9;e++)h[e]||(y+=5,h[e]=255)}m+=~~(y/3);let E=r.length;if(E<12||m>=37||r[E-1].armorRating<m){for(E>=12&&r[E-1].armorRating<m&&--E;E&&r[E-1].armorRating<m;)r[E]=r[--E];c.sort(((e,t)=>a[t].qurious-a[e].qurious)),r[E]={name:s,type:e,decos:f,augsPointer:3,augs:h,decoAugs:w,budget:0,baseBudget:y,skills:Object.fromEntries(g),skillLen:0,len:g.length,usedSkills:c,baseSkills:p,fodder:d[0]?d:"",fodderPointer:0,fodderCount:d[0]?d.length:"",armorRating:m},13===i.qTable&&(r[E].decos.map(((e,t)=>[1,1,0,1][t])),r[E].baseBudget=0,r[E].pointer=5,r[E].augs=new Uint8Array([255,255,255,255,252,253,255,255,255]))}}s[e]=r})),s}function I(e){let t="";const n=ae.armorTypes();for(let a=1;a<6;a++){const l=n[a-1];t+=`<img src="./icons/${l}.webp" class="armorImg ${l}"><span>${ve.armor[l][e[a]].name}</span>`}return t}function x(e){if(e.data){Ie+=e.data.count.combos,Ae+=e.data.count.sets,function(e){be.push(e);for(const t of e)t.armors[0]&&(Me+=`\n            <div class="setResult">\n                <button type="button" aria-pressed="false" class="equipBuild">Equip Build</button>\n                ${I(t.armors)}\n                <img src="./icons/charm.webp" class="armorImg charm">\n                <select class="armorCharm">${Ne(t.charms)}</select>\n            </div>`)}(e.data.sets);for(let t of e.data.sets)t?.armors&&(xe+=t.armors[0]);Te+=e.data.sets.length,document.getElementById("extraOutput").textContent=`Found ${Ae.toLocaleString()} Builds / ${Ie.toLocaleString()} Combos`,document.getElementById("setOutput").textContent=`Displayed ${Te} Builds / ${xe.toLocaleString()} Combos`;for(let t=0;t<4;t++)Se.remainingSlots[t]=qe(e.data.stats.remainingSlots[t],Se.remainingSlots[t]||0);for(let t=0;t<5;t++)Se.quriousSkills[t]=qe(e.data.stats.quriousSkills[t],Se.quriousSkills[t]||0);for(const[t,n]of Object.entries(e.data.stats.armorSkills))Se.allSkills[ve.types.skills[t].id].level=qe(Se.allSkills[ve.types.skills[t].id].level,n)}--Le||((e=>{let t="";e.forEach((e=>{e[1]&&(t+=`<button type="button" text="${e[0]}">${e[0].replace(/(?<=[a-z])([A-Z])(?![A-Z])/g," $1")} +${+e[1]}</button>`)})),document.getElementById("temp")&&document.getElementById("temp").remove(),document.querySelector(".extraSkills").innerHTML+=t,window.location.href.includes("github")})((()=>{let e=ve.types.skills;const t=Object.values(e);let{remainingSlots:n,quriousSkills:a,allSkills:l}=Se;for(let e of t)if(e.decos)for(let t=e.decos[0]-1;t<4;t++)l[e.id].level=t<3?Math.max(l[e.id].level,n[t]*e.decos[t+1]):Math.max(l[e.id].level,n[t]*e.decos[4]);for(const e of t){if(!e.qurious)continue;let t=e.qurious/3-1,n=5,s=0;for(;n-- >=t;)a[n]>s&&(s=a[n]);s>l[e.id].level&&(l[e.id].level=s)}return Object.values(l).map((e=>[e.name,Math.min(e.max,e.level)])).sort()})()),document.querySelector("div.grid").innerHTML=Me,Me="",Ie||(document.getElementById("setOutput").textContent="No Results Found",document.getElementById("extraOutput").textContent="No Results Found",document.querySelectorAll(".grid>div").forEach((e=>e.remove()))),function(e){const t=new XMLHttpRequest,n=`https://docs.google.com/forms/d/e/1FAIpQLSe0pQtcmqCLLYNCisWrPV_lMbvN8sk6xKgPe8DUqxuw7gswSg/formResponse?usp=pp_url&entry.1449573866=${e}&entry.1540814507=${Ae}&entry.1449980403=${Ie}`;t.open("POST",n),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send()}(performance.now()-ke))}function k(e){const t=be[Ce[0]][Ce[1]];t.decos=e.data.sets[0].decos;for(let n=1;n<6;n++)e.data.sets[0].armors[n]=t.armors[n];t.armors=e.data.sets[0].armors,performance.now()}function $(e){ae.$$("#charmSlots select, #dropWeapon,#dropWeaponType").forEach((t=>t.disabled=e))}function L(e){return`<img alt="${e} icon" src="./icons/${e}.webp">`}function b(){const e=document.getElementById("weaponFilter").classList.contains("selected");let t="";Fe[ae.weaponType()].weapons.forEach(((n,a)=>{e&&n.rank<10||(t+=`<option value="${a}">${n.weapon}`)})),ae.el.weapon.innerHTML=t}function C(e,t,n,a=60,l=0){let s=0;s+=l;let o=0,r=0;for(;o<=a;){let i=n;for(;i;)o+=e,r+=o<=a?1:0,r>=s&&0!==l&&l!==1/0?s+=l:--i;o+=t}return r}function T(e){let t=/Sub-Lv|Explosion| Procs|\(RF\+\d\)/g.test(e.attackName)?e.attackName.replace(/Sub-| Explosion| \(RF\+\d\) Procs| Procs| \(RF\+\d\)/g,""):e.attackName;t=/(?<!Lv)\d/.test(t)?`${t.slice(0,t.length-1)}Lv${t.slice(-1)}`:t;const n={};if(n.ammoIncrease=Je.ammo.AmmoUp[t][ae.selectedValue("AmmoUp")],n.recoilSpeed=Je.ammo.recoil[t][Math.max(0,Math.min(5,e.recoil-1+ae.selectedValue("RecoilDown")+(Je.skills.BowgunBarrel[ae.elSelectedIndex("BowgunBarrel")].Silencer>0?ae.selectedValue("Tune-Up")+Je.skills.BowgunBarrel[ae.elSelectedIndex("BowgunBarrel")].Silencer:0)-(ae.elSelectedIndex("CriticalFirePower")?2:0)))],n.recoilSpeed=/\(RF\+\d\)/.test(e.attackName)?`${n.recoilSpeed} ${e.attackName.match(/\(RF\+\d\)/)[0]}`:n.recoilSpeed,n.recoilFrames=Je.ammo.recoil.frames[n.recoilSpeed],n.reloadSpeed=Je.ammo.reload[t][Math.max(0,Math.min(8,e.reload+ae.selectedValue("ReloadSpeed")+Je.skills.BowgunBarrel[ae.elSelectedIndex("BowgunBarrel")].reload+(0===ae.elSelectedIndex("BowgunBarrel")&&ae.selectedValue("Tune-Up")?1:0)-(ae.elSelectedIndex("ElementalReload")?2:0)))],n.reloadFrames=Je.ammo.reload.frames[n.reloadSpeed],n.clipSize=e.clipSize[e.isUsed]+n.ammoIncrease,n.spareShot=Math.max(0,Je.skills.SpareShot[ae.selectedValue("SpareShot")]+Number(ae.elValue("spareAdjust"))),/(?<!snipe.*)explosion/.test(t)&&ae.elSelectedIndex("Bombardier")>0&&(n.spareShot+=Je.skills.Bombardier[t.match(/Sticky|Wyvern/)[0]][2]),n.shotsPerMinBase=C(n.recoilFrames/30,n.reloadFrames/30,e.clipSize[e.isUsed],60),n.shotsPerMin=C(n.recoilFrames/30,n.reloadFrames/30,n.clipSize,60,100/n.spareShot),n.shotsPerGain=`${(100*(n.shotsPerMin/n.shotsPerMinBase-1)).toFixed(2)}%`,t=t.replace(/ Lv/," "),++e.ticsPer,n.ticsAdjust=e.ticsPer,t.includes("Pierc")&&"Toadversary"!==ze.value&&(n.ticsAdjust=Math.min(7,Math.ceil(Je.monster[ze.value].size.gold/100/{PierceEle:3,"Pierce 1":1.5,"Pierce 2":1.1,"Pierce 3":1}[/Pierce L?v?\d/.test(t)?t:"PierceEle"]))*(e.attackName.includes("RF+")?+e.attackName.trim().slice(-2,-1):1)),/Pierc/.test(t)){const e=ae.elSelectedIndex("pierceAdjust")>=0?JSON.parse(ae.elValue("pierceAdjust")):[1,1];n.ticsAdjust*=/Lv|[1-3]/.test(t)?e[0]:e[1]}return n}function M(){let t=ae.weaponType();if("InsectGlaive"===t)return window.thisKey.InsectGlaive.attacks.filter((e=>!/Sever|Blunt|Kinsect|Dust|Powder|Mark/.test(e.attackName)));if("ChargeBlade"===t){const t="Impact Phial"===e().phialType?"Element Phial|Elemental Phial":"Impact Phial",n=new RegExp(t);return window.thisKey.ChargeBlade.attacks.filter((e=>!n.test(e.attackName)))}if("Bow"===t){let t="",{baseCharge:n,bowShot:a}=e();n+=1===ae.selectedValue("BowChargePlus")&&n<4?1:0;for(let e=0;e<n;e++)t+=`|Lv${a[e].match("[1-5]")[0]} ${a[e].match("Normal|Rapid|Pierce|Spread")[0]}`;const{attacks:l}=window.thisKey.Bow,s=new RegExp([t.slice(1)]),o=[l[0]];for(let e of l)s.test(e.attackName)&&o.push(e);return[...o,...l.slice(136)]}return"Gunlance"===t?window.thisKey.Gunlance.attacks.slice(0,27):window.thisKey[t].attacks}function R(t,n=0){const a=["purple","white","blue","green","yellow","orange","red"];let l=function(e){let[...t]=e;if(null==e[0])return;let n=document.getElementsByClassName("inputComboRepeat")[0].value;for(;n>1;)t=t.concat(e),--n;return t}(t);const s={purple:[],white:[],blue:[],green:[],yellow:[],orange:[],red:[]},o="Bow"!==ae.weaponType()?function(t){let n=function(){const t=["purple","white","blue","green","yellow","orange","red"];let n=10*ae.selectedValue("Handicraft");const{sharpness:a,handicraft:l,rank:s}=e();let o;for(let e=0;e<7;++e)if(a[t[e]]){o=e;break}for(let e=0;e<4;++e)if(!l[e+1]){l[e]+=70;break}let r=4===Qe.augIndex.sharpnessAug?50:10*Qe.augIndex.sharpnessAug;r+=10===s&&document.getElementById("augUpgrades").checked?20:0,n+=r;let i=t.length;for(;r&&i--;){let e=t[i],n=Math.min(a[e]-10,r);a[e]-=n,r-=n}for(;n;){const e=Math.min(n,l.shift());a[t[o]]+=e,--o,n-=e}return{...a}}();const a=Qe.skills.RazorSharp[ae.selectedValue("RazorSharp")].Sharp,l=Qe.skills.MastersTouch[ae.selectedValue("MastersTouch")].Sharp*t,s=t>0&&l?Xe(l)*Xe(a):Xe(a);return["purple","white","blue","green","yellow","orange","red"].forEach((e=>n[e]*=s)),n}(n):[0,0,0,1,0,0,0,0],r=Object.values(o).reduce(((e,t)=>e+t));if(l){let e=0;const t=M();e:for(const n of l){let l=t[n].ticsPer+1;const r=(i=t[n].hitsOfSharp,c=n,document.getElementById("ProtectivePolish").checked||"Bow"===ae.weaponType()?0:"Gunlance"!==ae.weaponType()||c>27?"DualBlades"!==ae.weaponType()?i:i/3:1);if("Gunlance"!==ae.weaponType()||n<27)for(;l--;){if(o[a[e]]<.1&&7==++e)break e;s[a[e]].push(n),o[a[e]]-=r}}}var i,c;return[o,s,r]}function A(e,t=ae.weaponType()){let{specialCase:n,selectedSkills:a}=window,{types:l}=tt;n.arr=[],e.skillRecord=new Set,e.stats={BR:0,BRM:1,PRM:1,BEM:1,BE:0,PEM:1,EFE:1,EFR:1,aff:e.baseAff};let s=document.querySelector("#weaponRampage0").value;et[s]&&ae.skillStats(e.stats,et[s](e));let o=Object.keys(a);for(const t of o)(!lt[t]&&l[e.type].includes(t)||lt[t]&&lt[t](e))&&n.add(t,e);return ae.stats(e.stats,n.arr),ae.$$("#dango select.skill:not(.classSpecific)").forEach((n=>{n.selectedIndex>0&&!e.skillRecord.has(n.id)&&(l[e.type]?.includes(n.id)||l[t].includes(n.id))&&(!lt[n.id]||lt[n.id](e))&&P(e,n.id,n.selectedIndex)})),document.querySelectorAll(`select.skill.classSpecific.${t}`).forEach((n=>{!(n.selectedIndex>0)||e.skillRecord.has(n.id)||lt[n.id]&&!lt[n.id](e)||lt[t][n.id]&&!lt[t][n.id](e)||P(e,n.id,n.selectedIndex)})),document.querySelectorAll("#boxes input.skillButton").forEach((t=>{!t.checked||e.skillRecord.has(t.id)||t.id.includes("Hunting")||(P(e,t.id),"DemonAmmo"===t.id&&/(Sever|Blunt)/.test(e.type)&&(e.stats.PRM*=1.1))})),"None"!==e.eleType&&"Heal"!==e.eleType&&l[e.eleType].forEach((t=>{ae.selectedValue(t)&&P(e,t,ae.selectedValue(t))})),"GreatSword"===t&&lt.GreatSword.ChargeLv(e),"SwitchAxe"===t&&("Impact Phial"===e.phialType?lt.SwitchAxe.ImpactPhial(e):lt.SwitchAxe.ElementalPhial(e)),e.stats.aff=Math.min(100,e.stats.aff)/100,e}function P(e,t,n){n?ae.stats(e.stats,tt.skills[t][n]):ae.stats(e.stats,tt.skills[t]),e.skillRecord.add(t)}function N(e,t=ot,n=0){return t.forEach((t=>{t==e&&++n})),n}function q(){window.selectedSkills={},window.specialCase={};for(const e of ae.$$("#EquippedSkillDisplay>output output")){let[t,n]=e.textContent.replace(/\s/g,"").split(":");const a={skillName:t,level:n,previous:e.previousElementSibling.textContent};window.selectedSkills[t]="Inactive"===a.previous?0:+n,window.selectedSkills[t]&&("Frostcraft"===a.skillName&&ae.weaponType().includes("BowGun")?window.selectedSkills.Frostcraft=Math.min(+n,a.previous.slice(-1)):it[a.skillName]&&(window.specialCase[t]=dt[t]?dt[t](a):ae.statsByValue(t)))}window.specialCase.add=(e,t)=>{window.specialCase.arr.push(window.specialCase[e]),t.skillRecord.add(e)},rt.BowCharge=ae.selectedValue("BowChargePlus"),/BowGun/.test(ae.weaponType())?function(){let t;ae.$("output.elementalAug").value=0,ce.elValue("elementalResult","+0"),ae.$("output.sharpnessAug").value=0,ce.elValue("sharpnessResult","+0");const n=[],a=[];let l=!0;const s=e();let o=0,r=!1;for(let e of rt.ammo.keys)if(e[0]&&0!==s.clipSize[rt.ammo.keys.indexOf(e)]&&!/Max|Error|Full/.test(e[0])){r="LightBowGun"===ae.weaponType()&&e.includes(s.isRapidFire[o]),o+=+r;for(let o=r?e.length/2:0;o<e.length&&(r||!e[o].includes("RF+"));o++){let r=A({...s,...rt.ammo[e[o]],attackName:e[o]});r=O(r),/Demon|Armor|Wyvern Blast|Full|Error|Max|Wyvernh|Glide|Wyvernsn|Guard/.test(r.attackName)?t.ticsAdjust=1:t=T(r);const i=~~((~~r.efr+~~r.efe)*t.ticsAdjust),c=~~(~~r.rawCrit+~~r.eleCrit),d=~~(~~r.rawNon+~~r.eleNon),u=~~(.99+ +ae.elValue("health")/i);let m=u*(60/t.shotsPerMin)+(/Stic|Slic/.test(r.attackName)?5:0),p=~~(m/60),g=~~(m%60);g<10&&(g=`0${g}`);let f=m.toString().match(/(?<=\.)\d?\d?/);f=f?f[0].length>1?f[0]:`${f[0]}0`:"00";let h=p>=100?"99'99\"99":m<=3||r.attackName.includes("Cluster")?"Unknown":`${p}'${g}"${f}`;const w=[`${~~r.rawNon} / ${~~r.rawCrit}`],y=[`${~~r.eleNon} / ${~~r.eleCrit}`],E=[`${~~d} / ${~~c}`],v=[r.attackName,w,y,E,i,"Infinity%"===t.shotsPerGain||"NaN%"===t.shotsPerGain||"0.00%"===t.shotsPerGain?"No Gain":t.shotsPerGain,/(\d{2},\d{3})/.test(u)?"N/A":u.toLocaleString(),h];n.push(v);const S=[r.attackName,r.rawMV,t.reloadSpeed||"N/A",t.recoilSpeed||"N/A",t.clipSize?t.clipSize:"N/A",r.ticsPer,t.shotsPerMinBase||"N/A",t.shotsPerMin||"N/A"];if(a.push(S),l){let e=r.stats.PRM;1===ae.elSelectedIndex("CriticalFirePower")&&(e/=1.3),ae.selectedValue("NormalRapidUp")&&(e/=it.NormalRapidUp[ae.selectedValue("NormalRapidUp")].PRM);const t=F(r.stats.aff,r.Crit),n=D(r.stats.aff,r.Crit);H([["Base",~~r.baseRaw,~~(.1+22*(1+r.raw/100))],["eTrue",~~r.raw,~~(.1+(22*r.stats.BEM+r.stats.BE)*(1+r.raw/100))],["Effective",~~(.1+r.raw*t.EFR*e),~~(.1+(22*r.stats.BEM+r.stats.BE)*(1+r.raw/100)*r.stats.PEM*n.EFE)],["True",~~(.1+r.raw*t.PRM*e),~~(.1+(22*r.stats.BEM+r.stats.BE)*(1+r.raw/100)*r.stats.PEM*n.PEM)],["Critical"].concat(Number(t.EFR).toFixed(3),Number(n.EFE).toFixed(2)),["Affinity",~~(100*r.stats.aff)]],"ammo"),l=!1}}}n.splice(0,0,["Ammo Type","Raw","Element",["Total","Combined Damage For a Single Tick"],["Effective","Calculates Every Tick Using EFE/EFR.\nMax Ticks Are Based On The Monster's Minimum \nLarge Gold Crown Size At Optimal FPS/Proc Rate.\nAdjust The Pierce Damage Adjust To Account For It Hitting Other Hit Zones."],["RPM Gain","The Percentage Increase Of Damage From Both \nAmmo Up And Spare Shot In 60 seconds."],["Shots To Kill","Use the Pierce Damage Adjust For Accurate Results"],["Time To Kill","Can Have Variance Due To FPS However\nThe Percent Difference Will Stay Constant\nThis Is The DPS Uptime To Kill Not A Quest Completion"]]),y(n,"dps"),a.splice(0,0,["Ammo Type","Raw MV","Reload","Recoil","Clip Size",["Procs Per","Maximum Ticks Per Shot Using Optimal FPS, \nAs Well As The Monsters Minimum Large Gold Crown Size"],["RPM Base","Shots Per Minute Including Recoil Down And Reload Speed"],["Current RPM","Shots Per Minute With AmmoUp And Spare Shot"]]),y(a,"ammo")}():function(){performance.now();let t=[0,0,0,0,0,0,0,0];const n=e(),a=M().map((e=>O(A({...e,...n}))));/Inputs|inputButton/.test(window.event?.target?.className)&&(function(){if(!document.getElementsByClassName("inputs")?.length)return;if(ot||(ot=[]),Number.isNaN(+window.event?.target?.id)||"0"===window.event?.target?.id)return;let e=+window.event?.target?.classList[2],t=+window.event?.target?.value-N(e);for(;t>0;)ot.push(e),--t;for(;t<0;)ot.splice(ot.lastIndexOf(e),1),++t}(),function(){if(!ot)return;let e;document.querySelectorAll("li.comboHits").forEach((e=>e.remove())),ot.forEach((t=>{e=document.createElement("li"),e.className=`${t} comboHits`,e.setAttribute("draggable","true"),e.textContent=document.querySelector(`#b${[t]}>output`).textContent,document.getElementById("comboCountDisplay").append(e)}))}());const l="Bow"===ae.weaponType()?R(ot)[1]:function(e,t=0){const n=["purple","white","blue","green","yellow","orange","red"],[a,l,s]=R(e,t);let o=Object.values(a).lastIndexOf(0);document.getElementById("Sharpness").selectedIndex=o<0?7:o;for(let e of n){const t=document.getElementById(e);t.style.width=a[e]/s*99.9+"%",t.textContent=a[e]<.1?"":~~a[e],t.style.display=""===t.textContent?"none":""}return l}(ot,a[0].stats.aff);t=function(e,t,n){const a=Object.entries(e).filter((e=>e[1].length>0));let l=new Set(ot);return a.forEach((e=>{for(let a of l){let l=N(a,e[1]);if(!l)continue;let s=t[a],{PRM:o,PEM:r}=s.noSharpMod?{PRM:1,PEM:1}:it.Sharpness[W(e[0])];ae.helpers.isStatusAttack(s.eleType)&&(r=1),n=[n[0]+=~~(s.rawMV*l),n[1]+=~~(s.rawNon*o)*l,n[2]+=~~(s.rawCrit*o)*l,n[3]+=~~(s.eleNon*r)*l,n[4]+=~~(s.eleCrit*r)*l,n[5]+=~~(s.rawNon*o)*l+~~(s.eleNon*r)*l,n[6]+=~~(s.rawCrit*o)*l+~~(s.eleCrit*r)*l,n[7]+=~~(s.efr*o)*l+~~(s.efe*r)*l]}})),n}(l,a,t);let s="";for(let e of Object.values(document.getElementsByClassName("sharpness")))e.textContent&&(s=e.id);s=it.Sharpness[W(s)];let o=a.map((e=>{let t="Bow"===ae.weaponType()||e.noSharpMod?{PRM:1,PEM:1}:s;ae.helpers.isStatusAttack(e.eleType)&&(t.PEM=1);const n=~~(e.rawNon*t.PRM),a=~~(e.eleNon*t.PEM),l=n+a,o=~~(e.rawCrit*t.PRM),r=~~(e.eleCrit*t.PEM),i=o+r,c=(~~(e.efe*t.PEM)+~~(e.efr*t.PRM))*(e.ticsPer+1);return["inputElementHere",e.attackName,e.rawMV.toFixed(1),`${n.toLocaleString()} / ${o.toLocaleString()}`,`${a.toLocaleString()} / ${r.toLocaleString()}`,`${l.toLocaleString()} / ${i.toLocaleString()}`,c.toLocaleString()]})),r="Bow"===ae.weaponType()||a[0].noSharpMod?{PRM:1,PEM:1}:s;ae.helpers.isStatusAttack(a[0].eleType)&&(r.PEM=1);const i="None"===a[0].eleType||"Heal"===a[0].eleType?0:a[0].ele;H([["Base",~~a[0].baseRaw,a[0].baseEle],["eTrue",~~a[0].raw,~~i],["True",~~(.1+a[0].raw*F(a[0].stats.aff,a[0].Crit).PRM*r.PRM),~~(.1+a[0].ele*D(a[0].stats.aff,a[0].Crit).PEM*r.PEM)],["Effective",~~(.1+a[0].raw*F(a[0].stats.aff,a[0].Crit).EFR*r.PRM),~~(.1+a[0].ele*D(a[0].stats.aff,a[0].Crit).EFE*r.PEM)],["Critical",Number(F(a[0].stats.aff).EFR).toFixed(3),Number(D(a[0].stats.aff).EFE).toFixed(2)],["Sharp",r.PRM,r.PEM],["Affinity",~~(100*a[0].stats.aff)]],a[0].eleType),o=[["Combo","Attack Name","MV","Raw","Element","Total","Effective"]].concat(o),"Gunlance"===ae.weaponType()?function(t,n,a){const l=`${e().shellingType} Lv${e().shellingLevel}`;let s=1,o=1;rt.Gunlance.attacks.forEach(((e,r)=>{if(!e.attackName.includes(l))return;s=~~(e.rawMV*it.Bombardier[ae.elSelectedIndex("Bombardier")][0]*ae.statsByValue("Artillery").BRM),o=~~(e.rawMV*it.Bombardier[ae.elSelectedIndex("Bombardier")][1]*ae.statsByValue("Artillery").BRM);const i=e.baseEle,c=["inputElementHere",e.attackName,e.rawMV,`${s}/${s}`,`${i}/${i}`,`${(s+i)*(e.ticsPer+1)}/${(s+i)*(e.ticsPer+1)}`,(o+i)*(e.ticsPer+1)];t.push(c);let d=N(r+27);n[1]+=s*d,n[2]+=s*d,n[3]+=i*d,n[4]+=i*d,n[5]+=(s+i)*(a.ticsPer+1)*d,n[6]+=(s+i)*(a.ticsPer+1)*d,n[7]+=(o+i)*(a.ticsPer+1)*d})),/inputs|inputButton/.test(window?.event?.target.className)||y(t,"dps");let r=document.querySelectorAll("tr.tableRowMelee:first-child>td:nth-child(n+3)");r[0].innerHTML=`${n[0].toLocaleString()}`,r[1].innerHTML=`${n[1].toLocaleString()}/${n[2].toLocaleString()}`,r[2].innerHTML=`${n[3].toLocaleString()}/${n[4].toLocaleString()}`,r[3].innerHTML=`${n[5].toLocaleString()}/${n[6].toLocaleString()}`,r[4].innerHTML=`${n[7].toLocaleString()}`}(o,t,a):(o.splice(1,1,["inputElementHere","Combo Damage",`${t[0].toLocaleString()}`,`${t[1].toLocaleString()} / ${t[2].toLocaleString()}`,`${t[3].toLocaleString()} / ${t[4].toLocaleString()}`,`${t[5].toLocaleString()} / ${t[6].toLocaleString()}`,`${t[7].toLocaleString()}`]),y(o,"dps")),window.location.href.includes("github")}(),a()}function D(e,t=!0){return t?{PEM:+it.CriticalElement[ae.selectedValue("CriticalElement")].PEM,EFE:1+(it.CriticalElement[ae.selectedValue("CriticalElement")].PEM-1)*e}:{PEM:1,EFE:1}}function F(e,t=!0){return t?{PRM:+it.CriticalBoost[ae.selectedValue("CriticalBoost")].PRM,EFR:1+(it.CriticalBoost[ae.selectedValue("CriticalBoost")].PRM-1)*e}:{PRM:1,EFR:1}}function O(e){return e.Raw?(e.raw=Math.min(~~(~~(~~e.baseRaw*e.stats.BRM+e.stats.BR+.1)*(document.getElementById("HuntingHornAttack").checked?1.1:1)),2600),window.selectedSkills.PunishingDraw&&(e.raw+=it.PunishingDraw[window.selectedSkills.PunishingDraw].BR),e.rawFormula=e.raw/100*e.stats.PRM*ae.rawHZ(ae.lower(e.type))*e.rawMV/100,e.rawNon=~~Math.max(1,.1+e.rawFormula),e.efr=~~Math.max(1,.1+e.rawFormula*F(e.stats.aff,e.Crit).EFR),e.rawCrit=~~Math.max(1,.1+e.rawFormula*(e.stats.highestRaw||1)*F(e.stats.aff,e.Crit).PRM)):[e.raw,e.rawNon,e.efr,e.rawCrit]=[0,0,0,0],e.NoEleBuff?[e.ele,e.eleNon,e.efe,e.eleCrit]=[e.baseEle,e.baseEle,e.baseEle,e.baseEle]:e.Ele&&"None"!==e.eleType?(e.eleAmmo=/BowGun$/.test(ae.weaponType())?1+e.raw/100:1,e.ele=Math.min(~~(.1+e.baseEle*e.stats.BEM+e.stats.BE),560),e.eleFormula=e.ele*e.stats.PEM*(ae.eleHZ(ae.lower(e.eleType))/100)*e.eleAmmo*e.eleMV,e.eleNon=~~Math.max(1,e.eleFormula>0&&e.eleFormula<1?1:~~e.eleFormula),e.efe=~~Math.max(1,.1+e.eleFormula*D(e.stats.aff,e.Crit).EFE),e.eleCrit=~~Math.max(1,.1+e.eleFormula*D(e.stats.aff,e.Crit).PEM)):[e.ele,e.eleNon,e.efe,e.eleCrit]=[0,0,0,0],{...e}}function H(e,t){let n=document.querySelectorAll(".statsEle");n[0].src.includes(ae.lower(t))||Object.values(n).forEach((e=>e.src=`./icons/${ae.lower(t)}.webp`)),e.forEach((e=>{ae.$$(`#stats${e[0]} span`).forEach(((t,n)=>t.textContent=e[n+1]))}))}function G(e){for(let t of document.getElementById("BowgunBarrel").options)t.disabled=!t.classList.contains(e),t.classList.toggle("augInvis",!t.classList.contains(e))}function V(t=ae.weaponType()){for(const e of Object.keys(rt.augIndex)){const t=document.querySelector(`output.${e}`);t.textContent=0,t.nextElementSibling.textContent="+0",rt.augIndex[e]=0}switch(t.includes("Bow")&&ce.selectedIndex("Sharpness",0),document.getElementsByClassName("inputs").length>0&&j(),t){case"DualBlades":it.Burst=it.BurstDualBlades;break;case"Bow":it.Burst=it.BurstBow;break;case"LightBowGun":G("LightBowGun"),it.Burst=it.BurstBowGun;break;case"HeavyBowGun":G("HeavyBowGun"),it.Burst=it.BurstBowGun;break;default:it.Burst=it.BurstStandard}it.Bombardier=/Gun|Charge/.test(t)?it.BombardierSource[t]:[],document.querySelectorAll(`.classSpecific:not(.${t})`).forEach((e=>{e.selectedIndex=0})),document.querySelectorAll(".classSpecific").forEach((e=>{e.classList.remove("augInvis"),e.parentElement.classList.remove("augInvis"),e.classList.contains(t)?"BUTTON"===e.tagName||"DIV"===e.tagName?e.classList.remove("augInvis"):e.parentElement.classList.remove("augInvis"):"BUTTON"===e.tagName||"DIV"===e.tagName?e.classList.add("augInvis"):e.parentElement.classList.add("augInvis")})),"ChargeBlade"===t&&function(){const t=e().phialType,n=document.getElementById("ImpactShieldCharge").parentNode,a=document.getElementById("EleShieldCharge").parentNode,l="Impact Phial"===t,s=l?"EleShieldCharge":"ImpactShieldCharge";n.classList.toggle("augInvis",!l),a.classList.toggle("augInvis",l),ce.selectedIndex(s,0)}()}function j(){document.getElementsByClassName("inputs").length&&(ae.elValue("previousWeaponType").includes("BowGun")||""===ae.elValue("previousWeaponType")||(document.querySelectorAll(".comboHits").forEach((e=>e.remove())),document.querySelectorAll("#dpsBody>tr:nth-child(1)>*:nth-child(n+3)").forEach((e=>e.value=0)),document.querySelectorAll(".inputs").forEach((e=>e.value=0)),document.querySelectorAll(".inputComboRepeat").forEach((e=>e.value=1)),ot=[]))}function W(e,t=0){return e[t].toUpperCase()+e.slice(1)}function U(e,t=0,n=window.event?.target.value){if("Select"===e||null!==document.getElementById(`${e}Select`)||"Select Skills For Set Builder"===n)return;const a=function(e,t){const n=document.createElement("div");return n.id=`${e}Select`,n.innerHTML=`\n      <label class="label ${e} skillInput animate-fade-in">${ct.skills.formatName(e)}</label>\n      <output class="skillInput ${e}" max="${ct.skills[e].maxLevel}" min="0">Lv-${t}</output>\n      <button type="button" aria-pressed="false" id="${e}Dec" class="skillInput ${e} dec animate-fade-in" data-tooltip="Decrease Skill Level">&#8681;</button>\n      <button type="button" aria-pressed="false" id="${e}Inc" class="skillInput ${e} inc animate-fade-in" data-tooltip="Increase Skill Level">&#8679;</button>`,n}(e,t),l=document.getElementById("searcherSkills"),s=Array.from(l.children),o=s.findIndex((t=>t.id.localeCompare(`${e}Select`)>0));-1===o?l.appendChild(a):l.insertBefore(a,s[o])}function K(e){return ae.$$(e).map((e=>e.selectedIndex))}function Z(e,t,n){if(!n&&performance.now()-window.saveDebouncer<1e3)return;window.saveDebouncer=performance.now();const a=ae.el.weaponType[t.weapon[0]].value;e[0].src.includes(a)||(e[0].src=`./icons/${a}.webp`),e[1].textContent=t.display[0],e[2].src.includes(t.display[1])||(e[2].src=`./icons/${t.display[1]}`),e[3].textContent=t.display[2]}function z(){let e=localStorage.getItem("index")||0;0===e&&localStorage.setItem("index",0);const[t,n]=function(){let e=[],t=[],n=ae.augmentSelects(),a=ae.augTypeSelects();for(let l=0;l<30;l++)t.push(a[l].selectedIndex),n[l].selectedIndex<=0||a[l].selectedIndex<=0?e.push(0):a[l].selectedIndex%2?e.push(n[l].selectedIndex):e.push(ae.idFromText(n[l].selectedOptions[0].text));return[t,e]}();let a={weapon:K(ut),armor:ae.el.armorSelects.map((e=>e.selectedIndex)),augment:n,augmentType:t,monster:[ae.el.mon2.value,ae.el.part.selectedIndex],remainingSelects:K(pt),charmLimiters:K(mt),checkBoxes:(l=gt,l.map((e=>e.checked?1:0))),setSearch:ae.$$("#skillSelect label").map((e=>[window.util.toSkillID(e.textContent),+e.nextElementSibling.textContent.slice(-1)])),display:[ft[0].textContent,ht.src.match(/\w+\.webp$/)[0],ft[1].textContent],version:st,import:ae.el.weapon.childElementCount>75};var l;localStorage.setItem(e,JSON.stringify(a)),Z(document.querySelectorAll(`#saveState${e} ~ *`),a)}function J(e){let n=localStorage.getItem("index");localStorage.setItem("index",e),document.getElementById(`saveState${n}`).textContent="Equip Build",document.getElementById(`saveState${e}`).textContent="Current Build";let a=localStorage.getItem(e);if(null===a)return;a=JSON.parse(a);const l=ae.el.weaponType[a.weapon[0]].value;let s=rt[l];if(a.import){let e=5;for(;e--&&s.weapons.length<75;){const e=new XMLHttpRequest;e.open("GET",`/MHR-Damage/LR/${l}.json`,!1),e.send(),e.responseText&&(s.weapons=[...s.weapons,...JSON.parse(e.responseText)])}for(e=5;e-- >=0&&!rt.rampage.Keys;){const e=new XMLHttpRequest;e.open("GET","/MHR-Damage/LR/rampage.json",!1),e.send(),e.responseText&&(rt.rampage={...rt.rampage,...JSON.parse(e.responseText)})}}!function(e,n){let a=e.version!==st;ce.selectedIndex("dropHZV2",e.monster[1]),ce.selectedIndex("dropWeaponType",e.weapon[0]);let l=e.weapon[1],s="";n.weapons.forEach(((e,t)=>{s+=`<option value="${t}">${e.weapon}`,e.index===l&&(l=t)})),ae.el.weapon.innerHTML=s,ce.selectedIndex("dropWeapon",l);let o=document.querySelector("#weapon > img");o.src=o.src.replace(/(\w+)\.webp$/,`${ae.elValue("dropWeaponType")}.webp`),V(ae.elValue("dropWeaponType")),E(),ce.weaponDisplay(ae.elValue("dropWeaponType")),ae.$$(mt).forEach(((t,n)=>{t.selectedIndex=e.charmLimiters[n]})),r("charm",e.charmLimiters.slice(1));const i=e.augmentType,m=e.augment;let p=0,g=0;const f=ae.augTypeSelects(),h=ae.augmentSelects(),w=e.armor;ae.el.armorSelects.forEach(((e,n)=>{e.selectedIndex=w[n],t(e.id),g+=6;const l=e.id;for(;p<g;){let e=f[p],t=h[p],n=i[p],s=m[p++];if(!(n<=0||s<=0&&!(n%2))){switch(n){case 1:e.selectedIndex=1,d(1,t,l,2);break;case 2:e.selectedIndex=2,d(2,t,l,window.thisKey.types.skills[s].name);break;case 3:e.selectedIndex=3,d(3,t,l,s);break;case 4:e.selectedIndex=4,d(4,t,l,window.thisKey.types.skills[s].name)}!a||n%2||(t.selectedIndex=s)}}c(e.id)})),ae.$$(pt).forEach(((t,n)=>{t.selectedIndex=e.remainingSelects[n]})),gt.forEach(((t,n)=>{t.checked=e.checkBoxes[n]})),e.setSearch.forEach((e=>U(ct.skills[e[0]].name,e[1]))),ge(),v(),u(e.monster[0],1),q()}(a,s)}var Q={d:(e,t)=>{for(var n in t)Q.o(t,n)&&!Q.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};Q.d({},{a:()=>V,b:()=>j,c:()=>U,d:()=>q});const{thisKey:X}=window,{skills:_,types:Y,quest:ee,monster:te}=X;let ne;const ae={$:e=>document.querySelector(e),$$:e=>Object.values(document.querySelectorAll(e)),helpers:{addSpaces:e=>window.thisKey.types.skills[e]?.name.replace(/(?<=[a-z])([A-Z])(?![A-Z])/g," $1")||e,isStatusAttack(e){if("None"!==e)for(let t of["Paralyze","Bomb","Sleep","Blast","Poison"])if(e===t)return!0}},el:{id:e=>document.getElementById(e),class:e=>document.getElementsByClassName(e),part:document.getElementById("dropHZ"),part2:document.getElementById("dropHZV2"),mon:document.getElementById("dropMonster"),mon2:document.getElementById("dropMonster2"),health:document.getElementById("health"),quest:document.getElementById("dropQuest"),weapon:document.getElementById("dropWeapon"),weaponType:document.getElementById("dropWeaponType"),armorSelects:Object.values(document.querySelectorAll("#helm,#chest,#arm,#waist,#leg")),armorDisplay:document.getElementById("armorSet"),weaponStatsDisplay:Object.values(document.querySelectorAll("#weapon .skillDiv:has(>img) *")),decoImages:function(){const e={};return["weapon","helm","chest","arm","waist","leg","charm"].forEach((t=>{e[t]=[Object.values(document.querySelectorAll(`section.${t} .decoDisplay img`)),Object.values(document.querySelectorAll(`section.${t} .decoDisplay img +select`))]})),e}()},lower:e=>e?e[0].toLowerCase()+e.slice(1):"",augTypeSelects(){return this.$$(".augmentType")},augmentSelects(){return this.$$(".augment")},elSelectedIndex:e=>Math.max(0,document.getElementById(e).selectedIndex),elValue:e=>document.getElementById(e).value,class:e=>document.getElementById(e).classList,weaponType(e){return!e&&ne||(ne=this.el.weaponType.value),ne},weapon(){return X[this.weaponType()].weapons[this.el.weapon.value]},HZVKeys:["part","sever","blunt","shot","fire","water","thunder","ice","dragon"],partIndex(e){e=e[0].toLowerCase()+e.slice(1);let t=this.HZVKeys;for(let n=0;n<9;n++)if(t[n]===e)return this.monHZ()[n]},mon(e=this.el.mon.value){return te[e]},monHZ(e=this.el.mon.value){return te[e].parts[Math.max(0,this.el.part2.selectedIndex)]},rawHZ(e){let t=this.partIndex(e);return t?document.getElementById("WaterBlight").checked?Math.min(100,~~(Math.max(t,.63*t+22.2)+3)):t:100},eleHZ(e){return this.helpers.isStatusAttack(e)?100:"None"===e||"none"===e?0:this.partIndex(e)},quest(e=this.el.quest.value){return ee[e]},quests:()=>ee,armorTypes:()=>["helm","chest","arm","waist","leg"],armor:e=>JSON.parse(JSON.stringify(X.armor[e][document.getElementById(e).value])),selectedValue(e){if(!window.selectedSkills[e])return 0;const t=this.cappedLevel(e);if(t<window.selectedSkills[e]){const n=Y.skills.formatName(e);return ae.$("#EquippedSkillDisplay output output").find((e=>e.value.includes(n))).classList.add("overLimit"),t}return window.selectedSkills[e]},cappedLevel:e=>Math.min(window.selectedSkills[e],Y.skills[e].maxLevel||_[e]?.length-1||7),skillInfo:(e,t)=>Y.skills[e][t],statsByValue(e){return _[e][this.selectedValue(e)]},statsByIndex(e){return _[e][this.elSelectedIndex(e)]},formattedName:e=>Y.skills.formatName(e),indexUsed(e,t){for(let n=0;n<e.childElementCount;n++)if(e.options[n].textContent.replace(/\s|[+-]\d+(Pts)?/g,"")===t){e.selectedIndex=n;break}},idFromText:e=>Y.skills[e.replace(/\s+|[+-]\d+(Pts)? ?$/g,"")].id,skillStats:(e,t,n,a)=>a?_[e][t][n][a]:n?_[e][t][n]:t?_[e][t]:_[e],stats(e,t){Array.isArray(t)||(t=[t]);for(let n of t)for(let t in n)2===t.length||"aff"===t?e[t]+=+n[t]:e[t]*=n[t];return e},searchSections(){let e={};return document.querySelectorAll("#searcherSkills>div>output").forEach((t=>{e[this.skillInfo(t.classList[1],"id")]=+t.value[3]})),e}},le=e=>document.getElementById(e)?.selectedIndex,{thisKey:se}=window,{types:oe}=se,re=["Dragon","Fire","Ice","Thunder","Water"],ie=e=>e.replace(/\s+|[+-]\d+(Pts)?/g,""),ce={defAug:()=>'<option value="0"> ---- <option value ="+3">-6 Def +3Pts<option value="+5">-12 Def +5Pts</option >',slotAug(e){let t=0,n="<option value='0'> ---- ";for(;++t<=e;){const e=-6*t;n+=`<option value="${e}"> +${t} Slot${t>1?"s":""} ${e}Pts`}return n},elValue(e,t){document.getElementById(e).value=t},selectedIndex(e,t){document.getElementById(e).selectedIndex=t},chooseProperty(e,t,n){ae.$(e)[n]=t},property(e,t,n){e[n]=t},addClass(e,t){ae.class(e).add(t)},removeClass(e,t){ae.class(e).remove(t)},toggleClass(e,t,n){ae.class(e).toggle(t,n)},innerHTML(e,t){e.innerHTML=t},selectText(e,t){let n="";for(let e=0;e<t.length;e++)n+=`<option>${t[e]}`;e.InnerHTML=n},swapFirstLetterCase:e=>(e.charCodeAt(0)>95?e[0].toUpperCase():e[0].toLowerCase())+e.slice(1),selectValues(e,t,n){let a="";for(let e=0;e<t.length;e++)a+=`<option value="${n[e]}">${t[e]}`;document.querySelector(e).InnerHTML=a},resetAll(e,t,n){const a=ae.$$(e);for(let e=0;e<a.length;e++)a[e][n]=t},weaponDisplay(t){t||=ae.weaponType();const n=e(),a=ae.el.weaponStatsDisplay;this.property(a[0],n.baseRaw,"textContent");let[l,s]=n.baseEle?[n.baseEle,n.eleType.toLowerCase()]:t.includes("BowGun")?["Ammo","ammo"]:[" 0 ","none"];this.property(a[2],l,"textContent"),this.property(a[3],a[3].src.replace(/(?<=icons\/).*?(?=\.)/,s),"src"),this.property(a[4],n.aff,"textContent");let o=4,i=[0,0,0],c=0;for(;o--;){let e=n.decos[o];for(;e--;)i[c++]=o+1}r("weapon",i)}};window.selectedSkills={};const{thisKey:de}=window,ue=["Hit Zone","sever","blunt","shot","fire","water","thunder","ice","dragon"],{skills:me}=window.thisKey.types,pe=[["Inactive"],["Lvl-1","Inactive"],["Lvl-2","Lvl-1","Inactive"],["Lvl-3","Lvl-2","Lvl-1","Inactive"]],ge=(e=!1)=>{let t="";const n=function(e={}){return ae.$$("select.armorDisplay, #charmSkill1,#charmSkill2").forEach((t=>{if(t.selectedIndex<1)return;const n=me.removeFormatting(t.selectedOptions[0].textContent,"name"),a=+t.selectedOptions[0].textContent.slice(-2);a>0&&(e[n]=(e[n]||0)+a)})),e}(function(e={}){return ae.armorTypes().forEach((t=>{ae.$$(`section.${t} .skillDiv>output`).forEach((t=>{if(!t.textContent)return;const n=me.removeFormatting(t.textContent,"name"),a=+t.textContent.slice(-2);a&&(e[n]=(e[n]||0)+a)}))})),e}()),a=Object.entries(n).sort(),l=document.querySelector("#EquippedSkillDisplay>output");let s=Object.values(l.children),o=1;for(let[n,l]of a){const a=me[n].maxLevel;if(a<l&&(l=a),!e&&window.selectedSkills[n]>=0){for(;me.removeFormatting(s[o].textContent,"name")!==n;)(o+=2)>=s.length&&(o=1);t+="Frostcraft"!==n?h(s,o,l):w(s,o,l);continue}let r="Active",i=["Active","Inactive"];"Dereliction"===n?(i=["Lvl-3","Inactive","Lvl-1","Lvl-2"],r=i[0]):"Fortify"===n?(i=["Inactive","Lvl-1","Lvl-2"],r=i[0]):"Frostcraft"===n?(i=pe[Math.min(3,+l)],r=i[0]):"Strife"===n?(i=["High","Low","Inactive"],r=i[0]):"BloodAwakening"===n&&(i=["Inactive","High","Low"],r=i[0]),t+=`<button type="button" aria-pressed="false" data-state="0" onclick="let states = ${JSON.stringify(i).replace(/"/g,"'")};\n         let index = (+this.dataset.state + 1) % ${i.length};\n         this.textContent = states[index]; \n         this.dataset.state = index;"\n         >${r}</button><output>${me.formatName(n)}: ${+l}</output>`}l.innerHTML=t,function(e){for(let t of ae.$$("#EquippedSkillDisplay>output>output")){const n=me.removeFormatting(t.textContent,"name");t.classList.toggle("overLimit",e[n]>me[n].maxLevel)}}(n)},fe=window.thisKey,{thisKey:he}=window;document.querySelectorAll(".augButton.inc").forEach((t=>t.addEventListener("click",(t=>(t=>{let n=t.className.match(/\w+Aug$/)[0],a=he.augIndex[n],l=he.augs[n];if(a+1===l.length||t.classList.contains("rampageAug")&&a+e().rampageSlots+1>3)return;const s=Object.entries(he.augs).reduce(((e,[t,n])=>e+n[he.augIndex[t]][0]),0)+(l[a+1][0]-l[a][0]);if(s>10)return;const o=t.parentElement.querySelector("output.label");he.augIndex[n]++,o.textContent=l[a+1][0],o.nextElementSibling.textContent=`+${l[a+1][1]}`,document.getElementById("weaponQurious").textContent=`Remaining Augments ${10-s}/10`,t.classList.contains("rampageAug")&&E(),ce.weaponDisplay()})(t.target))))),document.querySelectorAll(".augButton.dec").forEach((e=>e.addEventListener("click",(e=>(e=>{let t=e.className.match(/\w+Aug$/)[0],n=he.augIndex[t];if(0===n)return;const a=e.parentElement.querySelector("output.label");let l=he.augs[t];he.augIndex[t]--,a.textContent=l[n-1][0],a.nextElementSibling.textContent=`+${l[n-1][1]}`;let s=Object.entries(he.augs).reduce(((e,[t,n])=>e+n[he.augIndex[t]][0]),0);document.getElementById("weaponQurious").textContent=`Remaining Augments ${10-s}/10`,e.classList.contains("rampageAug")&&E(),ce.weaponDisplay()})(e.target)))));let we="",ye=document.getElementById("dropWeaponType");document.querySelectorAll(".buildSkills").forEach((t=>t.addEventListener("mousedown",(t=>{var n;(""===we||we!==t?.target||t.target.className.includes("augment"))&&(""!==we&&S(),t.target.classList.contains("skillArr")&&(n=t?.target,n.classList.contains("skillArr")&&Array.isArray(window.thisKey.skills[n.id])&&(window.thisKey.skills[n.id].forEach(((t,a)=>{let l;l=0===a?n.id:"RecoilDown"===n.id||"ReloadSpeed"===n.id?`${n.id.slice(0,6)} ${n.id.slice(6)} +${a}`:"AmmoUp"===n.id||"SpareShot"===n.id?`${a}: ${("AmmoUp"===n.id?["No Change","Lv2 & Ele Ammo","Lv3 & Dragon Ammo"]:["Spare Shot +5%","Spare Shot +10%","Spare Shot +20%"])[a-1]}`:"Marksman"===n.id?`${a}: ${["Chance 20% Raw + 5% EFR +1%","Chance 20% Raw +10% EFR +2%","Chance 60% Raw + 5% EFR +3% ","Chance 40% Raw +10% EFR +4%"][a-1]}`:"Bombardier"===n.id?"HeavyBowGun"===ye.value?["Bombardier","1: Raw + 10% EFR + 10%","2: Sticky+10% Wyvern+15%","3: Raw + 20% EFR + 16%","4: Raw + 25% EFR + 17%"][a]:`${a}: Raw +${window.thisKey.skills.Bombardier[a].PRM}% EFR +${window.thisKey.skills.Bombardier[a].EFR}`:"BowgunBarrel"===n.id?["Barrels","Long: Raw + 5%","Power: Raw + 12.5%","Silencer: Recoil Down +1","Shield: Guard Up"][a]:"CriticalFirePower"===n.id?["-","Normal +30% Spread +20% Pierce +10% Recoil -2"][a]:function(t,n,a,l){let s=function(e,t){let n="";if(e.BR>0||e.PRM>1||e.BRM>1){if(n="Raw",e.BR>0&&(n+=/\d\.?\d/.test(e.BR)?`+${e.BR}`:` + ${e.BR}`),e.BRM>1){const t=/\.[1-8]/.test(100*(e.BRM-1))?(100*(e.BRM-1)).toFixed(1):(100*(e.BRM-1)).toFixed(0);n+=/\d\.?\d/.test(t)?`+${t}%`:` + ${t}%`}if(e.PRM>1){const a=/\.[1-8]/.test(100*(e.PRM-1))?(100*(e.PRM-1)).toFixed(1):(100*(e.PRM-1)).toFixed(0);n+="CriticalBoost"===t.id&&/\d\.?\d/.test(a-25)?`+${a-25}%`:"CriticalBoost"===t.id?` + ${a-25}%`:/\d\.?\d/.test(a)?`+${a}%`:` + ${a}%`}}return n}(t,n);const o=function(e){let t="";if(e.BE>0||e.PEM>1||e.BEM>1){if(t="Ele",e.BE>0&&(t+=/\d\.?\d/.test(e.BE)?`+${e.BE}`:` + ${e.BE}`),e.BEM>1){const n=/\.[1-8]/.test(100*(e.BEM-1))?(100*(e.BEM-1)).toFixed(1):(100*(e.BEM-1)).toFixed(0);t+=/\d\.?\d/.test(n)?`+${n}%`:` + ${n}%`}if(e.PEM>1){const n=/\.[1-8]/.test(100*(e.PEM-1))?(100*(e.PEM-1)).toFixed(1):(100*(e.PEM-1)).toFixed(0);t+=/\d\.?\d/.test(n)?`+${n}%`:` + ${n}%`}}return t}(t),r=t.aff>0&&/\d\.?\d/.test(t.aff)?`Aff+${t.aff}`:t.aff>0?`Aff + ${t.aff}`:"";if(s=Object.prototype.hasOwnProperty.call(t,"Sharp")&&t.Sharp<1?`Sharp +${100*t.Sharp}%`:s,s=Object.prototype.hasOwnProperty.call(t,"Sharp")&&t.Sharp>1?`Sharp +${t.Sharp}`:s,s=""===s&&""===o&&""===r?"No Change":s,n===document.getElementById("BowCoating"))return`${e().coatings[l]}: ${[s,o,r].join(" ")}`;let i=l+0;return"OPTGROUP"===n.children[1].tagName&&0!==l&&(i="Burst"===n.id&&l>=2?l-1:l%3==0?3:l%3),`${i}: ${[s,o,r].join(" ")}`}(t,n,0,a),window.thisKey.descriptions[n.id]||(window.thisKey.descriptions[n.id]=[]),window.thisKey.descriptions[n.id].push(l),n.options[a].textContent=l})),we=n)),"INPUT"===t.target.tagName&&t.target.className.includes("skillInput")&&(we=t.target))})))),document.querySelector("#extraMenus").addEventListener("hover",(e=>{e.target.classList.includes("click")&&("LABEL"===e.target.tagName?e.target.children[0].id:e.target.id)}));const Ee=e=>{const{skills:t,skillLevels:n}=e,a=Object.entries(n).sort(((e,n)=>(e[2]||(e[2]=t[e[0]].qurious||6,e[3]=t[e[0]].decos?t[e[0]].decos[0]:5,e[4]=t[e[0]].decos?t[e[0]].decos[4]:5),n[2]||(n[2]=t[n[0]].qurious||6,n[3]=t[n[0]].decos?t[n[0]].decos[0]:5,n[4]=t[n[0]].decos?t[n[0]].decos[4]:5),e[2]-n[2]||e[3]-n[3]||e[4]-n[4]))),l=new Uint16Array(8*a.length),s=new Int8Array(4*a.length);let o=0,r=0;return a.forEach((([e,n])=>{const{id:a,decos:i,qurious:c,charm:d,maxLevel:u}=t[e],m=c||0,p=i&&i[0]<4?i[0]:0,g=i?i[4]:0,f=g&&n>=g&&m>=9&&(g>1||!c&&!i);l[o++]=n,l[o++]=n,l[o++]=m,l[o++]=i?f?4:5:8,l[o++]=g,l[o++]=p,l[o++]=i&&p<3?i[p+1]:0,l[o++]=a,s[r]=n,s[r+1]=n-u,d&&(!i&&!c||d[0]*m>=18)&&(d[0]<=n||!m?(s[r+2]=d[0],s[r+3]=d[1]):(d[1]<=n||!m)&&(s[r+3]=d[1])),r+=4})),{skillBuffer:l.buffer,infoBuffer:s}},{thisKey:ve}=window;window.descrepecies=[[],[],[],[],[]];let Se={};const Be=document.getElementById("dropWeapon");let Ie=0,xe=0,ke=0,$e=[],Le=0,be=[],Ce=[],Te=0,Me="",Re=!window.location.origin.includes("github"),Ae=0;const Pe={setReturn:document.getElementById("setReturn"),damageTable:document.getElementById("damageTable"),fodder:document.querySelector(".extraSkills"),setOutput:document.getElementById("setOutput"),extraOutput:document.getElementById("extraOutput"),grid:document.querySelector(".grid")},Ne=e=>{let t="",{skills:n}=ve.types,a=0;for(;e[a]!==e[a+1];){const l=n[e[a++]],s=n[e[a++]];t+=`<option>${l.name}: ${l.charm[0]} & ${s.name}: ${s.charm[1]}`}return t},qe=(e,t)=>e>=t?e:t,De=e=>{Re&&(ke=performance.now());const t=function(e){const t={skillLevels:{},skills:ve.types.skills,allArmors:e||ve.armor,decoSlots:[...ae.weapon().decos]};return document.querySelectorAll("#searcherSkills>div>output").forEach((e=>{const n=t.skills[e.classList[1]].id;t.skillLevels[n]=+e.textContent.slice(-1)})),document.querySelectorAll(".charmSlot").forEach((e=>{e.selectedIndex>0&&++t.decoSlots[e.selectedIndex-1]})),t}(e);$e.length&&$e.forEach((e=>e.terminate())),Le=e?1:4,$e=function(e,t){let n=[];for(let a=0;a<e;a++)n[a]=new Worker("./webWorker/setBuildWorker.js",{type:"module",name:`${a}`}),n[a].addEventListener("message",(e=>{t(e)}));return n}(Le,e?k:x);const n={skillBuffer:Ee(t),setLimiter:4-document.getElementById("skillsLimit").selectedIndex,armorObj:{armors:B(t),decoSlots:t.decoSlots}};let a=n.armorObj.armors.leg.splice(0),l=a.length%Le,s=~~(a.length/Le)||1;for(const e of $e){const t=s+ +(l-- >0);n.armorObj.armors.leg=a.splice(0,t),e.postMessage(n)}Le>1&&(e=>{be=[],Pe.setReturn.classList.remove("augInvis"),Pe.damageTable.classList.add("augInvis"),document.getElementById("temp")?.remove(),Pe.setOutput.textContent="Displayed 0 Builds / 0 Combos",Pe.extraOutput.textContent="Found 0 Builds / 0 Combos",Pe.fodder.innerHTML="<P2 id='temp' style='font-size:18px !important; height:15em !important;'>Searching...</P2>",Pe.grid.innerHTML="",Se={remainingSlots:[0,0,0,0],armorSkills:{},quriousSkills:[0,0,0,0,0],allSkills:{}};let t=Object.values(ve.types.skills);for(let n=0;n<147;n++){let a=t[n];Se.allSkills[a.id]={name:a.name,max:a.maxLevel-(e[a.id]?.points||0),level:0}}Te=0,be=[],Ie=0,xe=0,Ae=0})(t.skillLevels)},{thisKey:Fe}=window,Oe=ae.el.weaponType;document.querySelectorAll("select.skill").forEach((e=>e.addEventListener("change",(e=>{S(),e?.target.blur()})))),Oe.addEventListener("change",(()=>{ae.weaponType(!0),b(),document.getElementById("weaponFilter").classList.add("selected"),ce.weaponDisplay(),document.querySelector("#weapon > img").src=document.querySelector("#weapon > img").src.replace(/(?<=icons\/)\w+/,ae.weaponType()),V(),E(),v(),m()})),ae.el.weapon.addEventListener("change",(()=>{E(),ce.weaponDisplay(),v()})),document.querySelectorAll("select.menu").forEach((e=>e.addEventListener("change",(e=>{f(e.target.selectedOptions[0]),m(),g(e.target===ae.el.mon?ae.el.mon.value:ae.el.mon2.value)})))),document.getElementById("players")?.addEventListener("change",(()=>g(ae.el.mon2.value))),document.getElementById("dropQuest").addEventListener("change",(()=>{m(),g(ae.el.mon2.value)})),document.querySelectorAll("select.demon").forEach((e=>e.addEventListener("change",(e=>{document.querySelectorAll(`.demon:not(#${e?.target.id})`).forEach((e=>e.selectedIndex=0))})))),document.querySelectorAll(`#${ae.el.weapon.id}, #${Oe.id}`).forEach((e=>{e.addEventListener("change",(e=>{e.target!==Oe&&"ChargeBlade"!==ae.weaponType()||V()}))})),Object.values(document.getElementsByClassName("dropMons")).forEach((e=>{e.addEventListener("change",(e=>{(e.target===ae.el.mon?ae.el.mon2:ae.el.mon).selectedIndex=e.target.selectedIndex,e.stopPropagation(),u(e.target.value),q()}))})),document.querySelectorAll("section.armorDisplay").forEach((e=>{e.id.includes("weaponRampage")||e.addEventListener("change",(e=>{"SELECT"===e.target.tagName&&ge()}))}));for(let e of ae.$$("select.augmentType"))e.addEventListener("change",(e=>{e.target.nextElementSibling.selectedIndex=-1,e.target.nextElementSibling.innerHTML="",c(e.target.parentElement.parentElement.id.slice(0,-7))}));for(let e of ae.$$("select.augment"))e.addEventListener("change",(e=>{c(e.target.parentElement.parentElement.id.slice(0,-7))})),e.addEventListener("mousedown",(e=>{let t=e.target.selectedIndex<=0?void 0:e.target.previousElementSibling.selectedIndex%2?e.target.selectedIndex:e.target.selectedOptions[0]?.textContent;i(e.target,t),c(e.target.parentElement.parentElement.id.slice(0,-7))})),e.addEventListener("keydown",(e=>{if("Enter"===e.key){let t=e.srcElement.previousElementSibling.selectedIndex%2?e.srcElement.selectedIndex:e.srcElement.selectedOptions[0]?.textContent;i(e.srcElement,t),c(e.srcElement.parentElement.parentElement.id.slice(0,-7))}}));for(let e of ae.$$("#resistances select"))e.addEventListener("change",(()=>a()));const He=new Set(["DefenseBoost","Dragonheart","DragonConversion","Furious"]);document.querySelector("#weaponSelects>#Qurious")?.addEventListener("mousedown",(()=>{document.getElementById("augToggle").classList.remove("augInvis")})),ae.$$("#charmSlots .charmSlot").forEach((e=>e.addEventListener("change",(e=>{let[t,n,a,l,s]=document.querySelectorAll("#charm select"),o=a.selectedIndex;o>2&&(s.selectedIndex=1),o%2||(l.selectedIndex=Math.min(l.selectedIndex,4===o?1:2)),t.selectedOptions[0].textContent.split(" +")[0]===n.selectedOptions[0].textContent.split(" +")[0]&&(e.target===a?n.selectedIndex=0:t.selectedIndex=0),r("charm",[o,l.selectedIndex,s.selectedIndex])})))),document.getElementById("weaponFilter").addEventListener("click",(e=>{e.target.classList.toggle("selected");let t=ae.el.weaponType.value,n=Fe[t];if(!e.target.classList.contains("selected")){let e=5;for(;e--&&n.weapons.length<75;){const e=new XMLHttpRequest;e.open("GET",`/MHR-Damage/LR/${t}.json`,!1),e.send(),e.responseText&&(n.weapons=[...n.weapons,...JSON.parse(e.responseText)])}for(e=5;e-- >=0&&!Fe.rampage.Keys;){const e=new XMLHttpRequest;e.open("GET","/MHR-Damage/LR/rampage.json",!1),e.send(),e.responseText&&(Fe.rampage={...Fe.rampage,...JSON.parse(e.responseText)})}}b()})),document.querySelectorAll("#weaponFilter,button.rampageAug").forEach((e=>e.addEventListener("click",(()=>{E()})))),document.getElementById("EquippedSkillDisplay").addEventListener("click",(e=>{if("BUTTON"!==e.target.tagName)return;const t=e.target.nextElementSibling.textContent.replace(/\s/g,"").split(":")[0];(t.includes("Resist")||He.has(t))&&a()})),document.querySelector("#EquippedSkillDisplay").addEventListener("mouseover",(e=>{if(!Fe?.descriptions)return;let[t,n]=e.target.textContent.replace(/[\s\n\t]/g,"").split(":");n&&Fe.descriptions[t]&&(e.target.dataset.tooltip=Fe.descriptions[t][n-1])})),document.getElementById("searcherSkills").addEventListener("mouseover",(e=>{"OUTPUT"===e.target.tagName&&e.target.classList[1]&&Fe.descriptions[e.target.classList[1]]&&(e.target.dataset.tooltip=Fe.descriptions[e.target.classList[1]].join("\n"))})),document.querySelector(".extraSkills").addEventListener("mouseover",(e=>{"BUTTON"===e.target.tagName&&Fe.descriptions[e.target.textContent.replace(/\s/g,"").slice(0,-2)]&&(e.target.dataset.tooltip=Fe.descriptions[e.target.textContent.replace(/\s/g,"").slice(0,-2)].join("\n"))})),document.getElementById("dpsTable").addEventListener("input",(e=>{e.target.classList.contains("input")&&(e.target.value=Math.max(+("inputComboRepeat"===e.target.id),Math.min(20,e.target.value)))})),document.getElementById("dpsTable").addEventListener("mousedown",(e=>{if(!e.target.classList.contains("inputButton"))return;let t=e.target.parentElement.previousElementSibling.children[0];const n=e.target.classList.contains("dec")?-1:1;t.value=Math.max(+("inputComboRepeat"===e.target.id),Math.min(20,+t.value+n)),1===n?window.comboTracker.push(+e.target.id):window.comboTracker.splice(window.comboTracker.lastIndexOf(e.target.id),1),window.innerWidth>500&&document.getElementById("comboCountContainer")?.classList.remove("augInvis")})),ae.$$(".close").forEach((e=>e.addEventListener("click",(e=>{"extraSkillsHeader"===e.target.parentElement.id&&$(!1),e.target.parentElement.parentElement.classList.add("augInvis")})))),document.getElementById("settingsMenuButton").addEventListener("click",(e=>{e.target.textContent.includes("Open")?e.target.textContent="Close Settings":e.target.textContent="Open Settings",document.getElementById("settingsMenu").classList.toggle("augInvis"),ae.$$("#title,h2").forEach((e=>e.style.opacity=.2==e.style.opacity?1:.2)),e.target.classList.toggle("selected")})),ae.el.id("skillsMenu").addEventListener("mousedown",(()=>{ce.removeClass("skillSettings","augInvis"),ce.addClass("monsterSettings","augInvis"),ce.addClass("infoSettings","augInvis")})),ae.el.id("monsterMenu").addEventListener("mousedown",(()=>{ce.addClass("skillSettings","augInvis"),ce.removeClass("monsterSettings","augInvis"),ce.addClass("infoSettings","augInvis")})),document.getElementById("infoMenu").addEventListener("mousedown",(()=>{ce.addClass("skillSettings","augInvis"),ce.addClass("monsterSettings","augInvis"),ce.removeClass("infoSettings","augInvis")})),document.querySelector("#questButton").addEventListener("mousedown",(()=>function(){document.querySelectorAll(".menu").forEach((e=>e.classList.remove("augInvis")));const e=document.querySelectorAll("#MR>option").length>0;document.getElementById("MR").parentElement.classList.toggle("augInvis",!e);const t=document.querySelectorAll("#HR>option").length>0;document.getElementById("HR").parentElement.classList.toggle("augInvis",!t)}())),document.getElementById("boxes").addEventListener("mousedown",(e=>{const t="LABEL"===e.target.tagName?e.target.children[0]:e.target;if(/DemonDrug/i.test(t.id)&&("DemonDrug"===t.id?document.getElementById("MegaDemonDrug").checked=!1:document.getElementById("DemonDrug").checked=!1),"WaterBlight"===t.id){const e=ae.el.part.selectedIndex;m(),ae.el.part.selectedIndex=e}})),document.getElementById("scrollSwap").addEventListener("mousedown",(e=>{const t=e.target.classList.contains("Blue");ce.toggleClass("blueNon","augInvis",t),ce.toggleClass("blueScroll","augInvis",!t),ce.toggleClass("redNon","augInvis",!t),ce.toggleClass("redScroll","augInvis",t);const n=t?"blue":"red";Fe.skills.MailofHellfire=Fe.skills.MailofHellfireSource[n],Fe.skills.Dereliction=Fe.skills.DerelictionSource[n],q()})),document.querySelector(".extraSkills").addEventListener("mousedown",(e=>{if("BUTTON"===e.target.tagName&&!e.target?.classList[0]){let[t,n]=e.target.textContent.split(" +");t=t.replace(/\s/g,"");const a=document.querySelector(`output.${t}`);if(a){const e=Math.min(Fe.types.skills[t].maxLevel||Fe.skills[t].length-1,+a.textContent.slice(-1)+1);a.textContent=`Lv-${e}`,a.value=e}else U(t,n);e.target.remove()}})),document.getElementById("skillSelect").addEventListener("mousedown",(e=>{"skillInput"===e.target.classList[0]&&function(e,t){if("BUTTON"!==t.tagName)return;let n=t.classList.contains("dec")?-1:1,a=t.parentElement.querySelector("output"),l=+a.value.at(-1)+n;if(l<0)return void t.parentElement.remove();const s=Math.min(l,Fe.types.skills[e].maxLevel||Fe.types.skills[e]?.length-1||7);a.value=`Lv-${s}`}(e.target.classList[1],e.target)})),document.getElementsByClassName("close"),document.querySelectorAll("output.currentPoints").forEach((e=>{e.addEventListener("mousedown",(()=>{document.querySelectorAll(".armorAugment").forEach((e=>e.classList.toggle("augInvis")))}))})),document.getElementById("resetCombo").addEventListener("click",(()=>j())),document.getElementById("resetSkills").addEventListener("click",(()=>{document.querySelectorAll("#searcherSkills>div").forEach((e=>e.remove()))})),document.getElementById("ammoChange").addEventListener("click",(()=>function(){const e=document.getElementById("dpsTable").classList.contains("augInvis");document.getElementById("dpsTable").classList.toggle("augInvis",!e),document.getElementById("ammoTable").classList.toggle("augInvis",e)}()));let Ge=document.querySelector("#dropMonster"),Ve=document.querySelector("#dropMonster2");Ge.addEventListener("change",(function(){Ge.selectedIndex!==Ve.selectedIndex&&(Ve.selectedIndex=Ge.selectedIndex)})),Ve.addEventListener("change",(function(){Ve.selectedIndex!==Ge.selectedIndex&&(Ge.selectedIndex=Ve.selectedIndex)}));let je=document.querySelector("#dropHZV2");ae.el.part.addEventListener("change",(function(){ae.el.part.selectedIndex!==je.selectedIndex&&(je.selectedIndex=ae.el.part.selectedIndex)})),je.addEventListener("change",(function(){je.selectedIndex!==ae.el.part.selectedIndex&&(ae.el.part.selectedIndex=je.selectedIndex)})),document.body.addEventListener("click",(e=>{(/dec|inc|skill|input|scroll/.test(e.target.className)||/INPUT/.test(e.target.tagName)||"BUTTON"===e?.target.tagName&&document.getElementById("startSearch")!==e.target&&document.getElementById("extendedSearch")!==e.target)&&q()}));const We=window.location.href.includes("github")?"":"debug".split("");let Ue=0;We&&document.addEventListener("keydown",(e=>{if(isFinite(Ue))if(e.key===We[Ue])++Ue;else if(Ue<5)Ue=0;else if("Enter"===e.key){Ue=0;let e=document.createElement("script");e.src=".././src/konami.js",document.head.appendChild(e),Ue=null}})),ae.$("#myDialog").addEventListener("mousedown",(e=>{e.target.innerHTML=window.thisKey[Oe].weapons.flatMap((e=>function(e,t){let{raw:n,ele:a}=function(e,t){let n={raw:10,ele:0};if(t.includes("Bow"))return"Bow"===t?n.raw=15:"HeavyBowGun"===t&&(n.raw=20),n;if(/Water|Ice|Thunder|Fire|Dragon/.test(e))switch(n.raw=25,t){case"GreatSword":case"Hammer":n.ele+=30;break;case"lance":case"Gunlance":n.ele+=21;break;default:n.ele+=18}else n.raw=40;return n}(e.eleType,t),l=`\n        <section class="row">\n            <label class="labelWiki">${e.weapon}</label>\n            <div class="weaponWiki">\n                <section class="attackWiki">\n                    ${L("attack")}\n                    <output>${e.baseRaw}</output>\n                    <output>${e.baseRaw+n}</output>\n                </section>\n            </div>\n            <section class="affinityWiki">\n                ${L("affinity")}\n                <output>${e.aff}</output>\n            </section>\n            <section class="elementWiki">\n                ${L(e.eleType)}\n                <output>${e.baseEle}</output>\n                <output>${e.baseEle+a}</output>\n            </section>\n            ${function(e){let t="",n=3,a=4;for(;a--;){let l=e.decos[a];for(;l--;)--n,t+=L(`lvl${a+1}`)}for(;n--;)t+=L("lvl0");return`<div class="decoWiki">${t}${L(`ramp${e.rampageSlots}`)}</div>`}(e)}\n           \n        `;return ae.weaponType().includes("Bow")||(l+=function(e,t){let[n,a]=function(e,t){const n=["purple","white","blue","green","yellow","orange","red"];let a;for(let t=0;t<7;++t)if(e[n[t]]){a=t;break}let l=0;for(let e of t)l+=e;let s=l,o=0;for(;l;){const s=Math.min(l,t[o++]);e[n[a--]]+=s,l-=s}return[e,s]}({...e},t);for(let t of Object.values(e))a+=t;let l="";for(let[t,n]of Object.entries(e))l+=`\n      <div class="segment" style="background-color: ${t}; width:${n/a*100}%" title="${t}: ${n}"></div>\n    `;let s="";for(let[e,t]of Object.entries(n))s+=`\n      <div class="segment" style="background-color: ${e}; width:${t/a*100}%" title="${e}: ${t}"></div>\n    `;return`\n    <div class="sharpnessBarWrapper">\n      <div class="sharpnessBar top">${l}</div>\n      <div class="sharpnessBar bottom">${s}</div>\n    </div>\n  `}(e.sharpness,e.handicraft)),`${l}</section>`}(e,Oe)))}));let Ke=0,Ze=0;document.addEventListener("change",(e=>{"SELECT"===e.target.tagName&&q()})),document.addEventListener("keypress",(e=>{e.key===["t","e","s","t"][Ke++]&&!(Ze=0)||e.key===["b","u","i","l","d"][Ze++]&&!(Ke=0)||(("Enter"===e.key&&Ke>=3||"Enter"===e.key&&Ze>=4)&&(Ke<3?[["AttackBoost",7],["Bloodlust",3],["Burst",3],["Strife",3],["Coalescence",1],["CriticalBoost",3],["CriticalElement",3],["Dragonheart",5],["DragonAttack",5],["ElementExploit",3],["Frostcraft",3],["Resentment",5],["MailofHellfire",3],["Agitator",5],["DragonConversion",3],["WeaknessExploit",3]].forEach((e=>U(e[0],e[1]))):[["PeakPerformance",3],["Coalescence",3],["CriticalEye",7],["CriticalBoost",3],["MaximumMight",3],["RecoilDown",3],["ReloadSpeed",3],["RapidFireUp",3],["PierceUp",3],["Burst",1],["Agitator",5],["AttackBoost",7],["AmmoUp",2],["SpareShot",3],["WeaknessExploit",3],["Tune-Up",1],["Bloodlust",1]].forEach((e=>U(e[0],e[1]))),setTimeout((()=>{De()}),1)),Ke=0,Ze=0)})),ae.$$("#startSearch, #extendedSearch").forEach((e=>e.addEventListener("click",(()=>{De(),$(!0)})))),document.querySelector(".grid").addEventListener("change",(e=>{"SELECT"===e.target.tagName&&function(e){const t=ae.$$(".setResult").indexOf(e.parentElement);Ce[0]=~~(.2*t),Ce[1]=t%5;const{charms:n,armors:a}=be[Ce[0]][Ce[1]],l=2*e.parentElement.lastElementChild.selectedIndex,s=(n[l],n[l+1],ae.armorTypes()),o={};for(let e=1;e<6;e++)o[s[e-1]]=[ve.armor[s[e-1]][a[e]]];De(o)}(e.target)})),document.querySelector(".grid").addEventListener("mousedown",(e=>{"BUTTON"===e.target.tagName&&function(e){const s=ae.$$(".setResult").indexOf(e.parentElement);Ce[0]=~~(.2*s),Ce[1]=s%5;const r=be[Ce[0]][Ce[1]];if(!r)return;const i=2*e.parentElement.lastElementChild.selectedIndex;if(((e,t)=>{const n=ae.$$("select.charm");for(let a=0;a<2;a++){let l=ve.types.skills.formatName(e[t++]),s=n[a];for(let e=0;e<s.childElementCount;e++)if(s.options[e].textContent.includes(l)){s.selectedIndex=e;break}}})(r.charms,i),function(e,a){const s=ae.el.armorDisplay,r=ae.searchSections();let i=0,c=ae.armorTypes();for(let d=0;d<5;d++){const u=c[d];let m=s.children[d+1],p=e.subarray(i,i+=6);ce.selectedIndex(u,a[d]),t(u);let g=0,{qurious:f,skills:{...h},decos:{...w},decoAugs:y}=ae.armor(u),E=f,v=m.querySelectorAll(".augmentType"),S=m.querySelectorAll(".augment");for(let e=0;e<6;e++){let t=p[e];if(250===t)continue;let n,a,l,s,o=255===t?1:t>250?3:r[t]&&!h[t]||r[t]>h[t]?4:2;switch(v[e].selectedIndex=o,o){case 1:f+=5,S[e].innerHTML=ce.defAug(),S[e].selectedIndex=2;break;case 3:let o=255-t;if(l=6*o,f<l)break;for(S[e].innerHTML=ce.slotAug(Math.min(3,~~(f/6))),f-=l,S[e].selectedIndex=o;o--;)s=y[g++],++w[s],s&&--w[s-1];break;case 2:if(a=oe.skills[t],n=oe.skills.formatName(t),0===h[t])break;S[e].innerHTML=`<option value="0"> ---- \n             <option value="10"> ${n} +10Pts`,f+=10,--h[t],S[e].selectedIndex=1;break;case 4:if(a=oe.skills[t],n=oe.skills.formatName(t),f<a.qurious)break;f-=a.qurious,h[t]=(a[t]||0)+1,S[e].innerHTML=`<option value="0"> ---- \n                 <option value="${-a.qurious}"> ${n} ${-a.qurious}Pts`,S[e].selectedIndex=1}}o(u,h);let B=4,I=0,x=[0,0,0];for(;I<3&&B--;){let e=w[B];for(;e--;)x[I]=B+1,++I}l([u]),n(u,f,E)}}(r.armors.subarray(6,36),r.armors.subarray(1,6)),function(e){for(let t=0;t<4;t++){let n="",a=0;const l=ae.$$(`.lvl${t+1} +select:has(>option)`);for(let s=0;s<l.length;s++)if(n!==e[t][s]){n=e[t][s];for(let e=0;e<l[s].children.length;++e)if(+l[s].options[e].value<=t+1&&l[s].options[e].textContent.includes(n)){l[s].selectedIndex=e,a=e;break}}else l[s].selectedIndex=a}}((e=>{const t=[[],[],[],[]];let n=0;for(;n<e[63];){const a=oe.skills.formatName(e[n++]),l=e[n++];let s=e[n++];for(;s--;)t[l].push(a)}return t})(r.decos)),document.getElementById("setReturn").classList.add("augInvis"),document.getElementById("damageTable").classList.remove("augInvis"),$(!1),document.querySelectorAll(".extraSkills>button").forEach((e=>e.remove())),ge(!0),a(),Re){const e={};document.querySelectorAll("#searcherSkills>div>output").forEach((t=>{const n=t.className.split(" ")[1];e[n]={totalPoints:+t.textContent.slice(-1)}}));let t=[...ve[ae.weaponType()].weapons[Be.value].decos];document.querySelectorAll(".charmSlot").forEach((e=>{e.selectedIndex>0&&++t[e.selectedIndex-1]})),window.verifyBuild&&window.verifyBuild(r,be[s].armors,e,t)}document.querySelector("div.grid").innerHTML="",$e.forEach((e=>e.terminate())),$e=[],be=[]}(e.target)}));const ze=document.getElementById("dropMonster2"),{thisKey:Je}=window,{thisKey:Qe}=window,Xe=e=>1/(1-e),_e=e=>window.thisKey.skills[e][1],Ye=()=>Object.values(window.thisKey.monster[ae.elValue("dropMonster2")].species),et={"Hellion Mode":()=>"DualBlades"===ae.weaponType()?{aff:20}:{},"Valstrax Soul":e=>"Dragon"===e.eleType?_e("ValstraxSoul"):{},"Kushala Daora Soul":()=>_e("KushalaDaoraSoul"),"Dulling Strike":()=>document.getElementById("Sharpness").selectedIndex<5?_e("DullingStrike"):{},"Wyvern Exploit":()=>"Invalid"!==Ye[1]?_e("AntiSpecies"):{},"Fanged Exploit":()=>Ye[3]?_e("AntiSpecies"):{},"Anti-Aerial Species":()=>"Arial"===Ye[2]?_e("AntiSpecies"):{},"Anti-Aquatic Species":()=>"Aquatic"===Ye[2]?_e("AntiSpecies"):{},"Fireblight Exploit":()=>_e("ElementalBlightExploit"),"Waterblight Exploit":()=>_e("ElementalBlightExploit"),"Iceblight Exploit":()=>_e("ElementalBlightExploit"),"Thunderblight Exploit":()=>_e("ElementalBlightExploit"),"Dragonblight Exploit":()=>_e("ElementalBlightExploit"),"Magnamalo Soul":()=>_e("MagnamaloSoul"),BrutalStrike:(e,t)=>(0===t.BrutalStrike?e.efrMulti=-1*e.stats.aff*.2*1.5-.8*e.stats.aff*.75:e.efrMulti=-1*e.stats.aff*.25*2- -1*e.stats.aff*.75*.75,{critBoost:1.5}),"Element Exploit":e=>{if(ae.eleHZ(e.eleType)>=25&&(/Fire|Water|Ice|Thunder|Dragon/i.test(e.eleType)||ae.weaponType().includes("BowGun")&&/Fire|Water|Ice|Thunder|Dragon/i.test(e.attackName)))return{PEM:0===e.rampageSlots?1.3:1.15}}},{thisKey:tt}=window,nt=new Set(["Sticky","Wyvern"]),at=new Set(["Normal","Spread","Pierce"]),lt={Agitator:()=>document.getElementById("enraged").classList.contains("selected"),OffensiveGuard:()=>/^(Charge|Sword|HeavyBowGun|Lance|Great)/.test(ae.weaponType()),WeaknessExploit:e=>ae.rawHZ(ae.lower(e.type))>=45,ElementExploit:e=>ae.eleHZ(ae.lower(e.eleType))>=20,SneakAttack:e=>!e.NoSneak,BloodAwakening:()=>!0,Artillery:e=>"IgnoreHZV"===e.type&&/Gun$|^Charge|^Gun/.test(ae.weaponType()),RapidMorph:e=>/Morph|Condensed Spinning|Up Roundslash/.test(e.attackName),ChargeMaster:e=>e.ChargeMaster,MindsEye:e=>~~(25/JSON.parse(ae.elValue("Sharpness")).PRM)>=ae.rawHZ(ae.lower(e.type)),PierceUp:e=>/Pierce L?v?\d/.test(e.attackName)&&/BowGun$|^Bow$/.test(ae.weaponType()),SpreadUp:e=>/Spread/.test(e.attackName)&&/BowGun$|^Bow$/.test(ae.weaponType()),NormalRapidUp:e=>/Normal|Rapid/.test(e.attackName)&&/BowGun$|^Bow$/.test(ae.weaponType()),SpecialAmmoBoost:e=>/Wyvern|Pierce/.test(e.attackName)&&/BowGun$|^Bow$/.test(ae.weaponType()),RapidFireUp:e=>/RF\+/.test(e.attackName),DragonConversion:e=>/Fire|Water|Ice|Thunder|Dragon/i.test(e.eleType)||/Fire|Water|Ice|Thunder|Dragon/i.test(e.attackName),Frostcraft(e){if(!ae.weaponType().includes("BowGun"))return!0;let t=e.attackName.split(" ")[0];tt.skills.Frostcraft[t]||(t=ae.weaponType());let n=tt.skills.Frostcraft[t][window.selectedSkills.Frostcraft];e.stats.PRM*=n.PRM,e.stats.PEM*=n.PEM,e.skillRecord.add("Frostcraft")},Bombardier:e=>{if("IgnoreHZV"!==e.type||"ChargeBlade"===ae.weaponType()&&!e.phialType.includes("Impact"))return;if("ChargeBlade"===ae.weaponType()&&e.phialType.includes("Impact")||"Gunlance"===ae.weaponType())return!0;let t=e.attackName.slice(0,6);if(nt.has(t)){if("LightBowGun"===ae.weaponType())return!0;e.stats.PRM*=ae.statsByIndex("Bombardier")[t].PRM,e.skillRecord.add("Bombardier")}},ChargeBlade:{SavageAxe:e=>!/3rd|(?<!Midair |Axe: )UED|(?<!Charged )Sword(?!.*Shield)/.test(e.attackName),ImpactShieldCharge:e=>"Impact Phial"===e.phialType,EleShieldCharge:e=>"Element Phial"===e.phialType},LongSword:{SpiritGauge:e=>!/Helm Breaker|Serene/.test(e.attackName),Helmbreaker:e=>/Helm Breaker/.test(e.attackName),SerenePose:e=>/Serene/.test(e.attackName)},GreatSword:{StrongarmStance(e){const t=e.attackName.match(/Charged Slash|Rising Slash|Wide Slash|Strong Charged Slash|True Charged Slash|Rage Slash/);t&&P(e,"StrongarmStance",t)},PowerSheath:()=>!0,ChargeLv(e){let t=e.attackName.match(/(?<=Lv)[1-3]/);t&&!e.attackName.includes("Tackle")&&(e.rawMV*=Number(`1.${t[0]}`),e.skillRecord.add(`ChargeLv${t[0]}`))}},Lance:{LanceCharge:()=>!0},InsectGlaive:{KinsectBuff:()=>!0},DualBlades:{ArchdemonMode:()=>!0,DemonMode:e=>!/Feral Demon Mode/.test(e.attackName),FeralDemonMode:e=>!/Demon Mode/.test(e.attackName)},SwitchAxe:{ImpactPhial:e=>{/Sword|Elemental|ED/.test(e.attackName)&&(e.stats.BRM*=1.15,e.skillRecord.add("Impact Phial"))},ElementalPhial:e=>{/Sword|Elemental|ED/.test(e.attackName)&&(e.stats.BEM*=1.45,e.skillRecord.add("Elemental Phial"))}},Bow:{BowCoating(e){e.attackName.includes("Stake")||(ae.skillStats(e.stats,tt.skills[document.getElementById("BowCoating").selectedOptions[0].text]),e.skillRecord.add("BowCoating"))},HerculesDraw:()=>!0,UpperCrit:()=>!0,chargeLevel:()=>!0},HeavyBowGun:{chargeLevel(e){if(!/snipe|heart|Cluster/.test(e.attackName)){if(!e.NoEleBuff)return!0;e.baseRaw*=window.skillStats.ChargeLevel[document.getElementById("ChargeLevel").selectedIndex].PRM,e.skillRecord.add("ChargeLevel")}}},LightBowGun:{EvadeHop:()=>!0,FanningManeuver:()=>!0,ElementalReload:()=>!0,CriticalFirePower:e=>{let t=e.attackName.slice(0,6);at.has(t)&&("Pierce"!==t||/Pierce L?v?\d/.test(e.attackName))&&P(e,"CriticalFirePower",t)}}};window.comboTracker=[];const st="2";window.specialCase={},window.skillStats={};let{comboTracker:ot}=window;const{thisKey:rt}=window,{skills:it,types:ct}=rt,dt={Dereliction:e=>ae.skillStats("Dereliction",e.level,e.previous.slice(-1)),Strife:e=>ae.skillStats("Strife",e.previous,e.level),BloodAwakening:e=>ae.skillStats("BloodAwakening",ae.weaponType().includes("BowGun")?"gunner":"melee",e.previous,e.level),Fortify:e=>ae.skillStats("Fortify",e.previous.slice(-1)),ChargeLevel:()=>ae.statsByIndex("ChargeLevel"),Bombardier:()=>ae.skillStats("Bombardier"),Frostcraft:e=>ae.skillStats("Frostcraft","Bow"===ae.weaponType()?"Bow":"melee",e.previous.slice(-1)),DragonConversion:()=>{const e=ae.weaponType().includes("BowGun")?"ranged":"melee";let t=0,n=ae.$$("#weapon .eleDiv:not(.def)>output");for(let e of n)t+=Math.min(50,Math.max(0,+e.textContent));return{BE:t*ae.statsByValue("DragonConversion")[e]}},Bludgeoner(){const e=ae.elSelectedIndex("Sharpness"),t=ae.elSelectedIndex("Bludgeoner");return e<4&&t>1||e>2&&t<4?ae.skillStats("Bludgeoner",2):1===t&&e<4?ae.skillStats("Bludgeoner",1):ae.skillStats("Bludgeoner",0)}};window.combos={total:new Set},ae.el.armorSelects.forEach((e=>e.addEventListener("change",(function(){t(e.id)})))),l();const ut="#dropWeaponType,#dropWeapon",mt="#charmSlots select",pt=`select:not(${ut},${ae.armorTypes().map((e=>`#${e}`)).join(",")},.augmentType,.augment,#dropMon2,#dropHZV2,#dropSkills,#charmSlots select)`,gt=ae.$$(".check:not(label)"),ft=document.querySelectorAll("#statsEffective span"),ht=document.getElementsByClassName("statsEle")[0];let wt=localStorage.getItem("index");if(null!==wt){J(+wt);for(let e=0;e<5;++e){let t=localStorage.getItem(e);t&&Z(document.querySelectorAll(`#saveState${e} ~ *`),JSON.parse(t),1)}}else V("LightBowGun"),r("charm",[2,2,2]),r("weapon",[4,2,0]),function(){if(!rt.LightBowGun.weapons)return;let e="";rt.LightBowGun.weapons.forEach(((t,n)=>{e+=`<option value="${n}">${t.weapon}`})),document.getElementById("dropWeapon").innerHTML=e}(),ae.el.quest.innerHTML=`<option value="${rt.quest.length-1}">${rt.quest.at(-1).quest}>`,u("Toadversary",1),E(),q(),z();[ae.el.weapon,ae.el.weaponType].forEach((t=>{t.addEventListener("change",(()=>{if("Bow"!==ae.weaponType())return;document.querySelectorAll("#BowCoating>option").forEach((e=>e.remove()));const t=[];e().coatings.forEach((e=>{const n=document.createElement("option");n.textContent=e,document.getElementById("BowCoating").append(n),t.push(it[e])})),it.BowCoating=t}))})),document.getElementById("dropSkills")?.addEventListener("change",(e=>{const t=e.target.value.replace(/\s+/g,"");U(t,ct.skills[t].maxLevel)})),window.saveDebouncer=0,document.body.addEventListener("change",(()=>{performance.now()>5e3&&z()})),document.body.addEventListener("click",(()=>{performance.now()>5e3&&z()})),ae.$$(".load").forEach((e=>e.addEventListener("click",(e=>{J(e.target.id.slice(-1))}))));const yt=document.getElementById("comboCountContainer");yt.addEventListener("dragstart",(e=>{var t;e.dataTransfer.setData("text/plain",(t=e.target,Object.values(document.getElementById("comboCountDisplay").children).indexOf(t)))})),yt.addEventListener("dragover",(e=>{e.preventDefault(),"LI"===e.target.tagName&&(e.dataTransfer.dropEffect="move",e.target.classList.add("dragover"))})),yt.addEventListener("dragleave",(e=>{"LI"===e.target.tagName&&e.target.classList.remove("dragover")})),yt.addEventListener("drop",((e=window.event)=>{if(e.preventDefault(),"LI"!==e.target.tagName)return;e.target.classList.remove("dragover");const t=e.dataTransfer?.getData("text/plain");"comboCountDisplay"===e.target.parentElement.id&&e.target.before(Object.values(e.target.parentElement.children)[+t]),ot=ae.$$("#comboCountDisplay li").map((e=>e.classList[0])),q()}))})();