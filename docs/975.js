(self.webpackChunkmhrdamage=self.webpackChunkmhrdamage||[]).push([[975],{975:(e,t,s)=>{s.r(t),s.d(t,{getSetBuilds:()=>q,getSkillReq:()=>S,testBuild:()=>I});var o=s(16),l=s(6),i=s(923);const n=(e=window.thisKey.types)=>{const t={},s={};return document.querySelectorAll("#searcherSkills>div>output").forEach((o=>{const l=o.className.split(" ")[1];t[l]=-o.textContent.match(/(?<=Lv-)\d/)[0],s[l]={lvl:e.decos[l]??5,lvl4:e.lvl4[l]??0,qurious:~~((e.qurious[l]??(window.thisKey.charms[l]||e.decos[l]?30:60))/3)},5===s[l].lvl&&s[l].qurious>5&&(window.thisKey.charms[l]?(s.charmNeeded||(s.charmNeeded={}),s.charmNeeded[l]=-t[l],s.charmSkillPoints=window.thisKey.charms[l][0][0]):(s.setBonus||(s.setBonus={}),s.setBonus[l]=-t[l]))})),{skills:Object.fromEntries(Object.entries(t).sort(((e,t)=>s[t[0]].lvl-s[e[0]].lvl||s[e[0]].qurious-s[t[0]].qurious))),skillInfo:s}};let r={};const a=document.getElementById("dropWeapon"),u=document.getElementById("dropWeaponType");let c=0,d=0,m=[];var f=0;let h=0,g=new Map,k=!window.location.origin.includes("github"),p=0;const y=e=>{const t=[];for(let s of e)for(let e of s.charm)t.push(`${e[0][0]}: ${e[0][1]} & ${e[1][0]}: ${e[1][1]}`);return t},S=(e=[])=>(document.querySelectorAll(".buildSkills>div>.skill").forEach((t=>{t.selectedIndex>0&&e.push([t.id,t.selectedIndex])})),e),w=(e,t)=>e>=t?e:t;function E(){for(let e=0;e<5;e++)m[e]=new Worker("./setBuildWorker.js",{name:e});m.forEach((e=>{e.addEventListener("message",(e=>{--h,e.data.final.sets.length&&(c+=e.data.final.count.combos,p+=e.data.final.count.sets,g.size<100&&(e=>{for(const t of e){if(g.size<100){g.set(g.size,t);const e=y(t.usedSkills);let s='<button type="button" aria-pressed="false" class="equipBuild">Equip Build</button>';const o=Object.keys(t.usedSkills[0].augments);for(let e=0;e<5;e++)s+=`<output class="armorImg ${(0,i.VW)()[e]}"></output><span>${o[e]}</span>`;let l="";e.forEach((e=>{l+=`<option value="${e}">${e}</option>`})),s+=`<output class="armorImg charm"></output><select class="armorCharm" title="charmSkill1">${l}</select>`;const n=document.createElement("div");n.classList.add("setResult"),n.innerHTML+=s,s="",document.querySelector(".grid").appendChild(n)}let e=0;for(let t of g.values())t.count&&(e+=t.count);document.getElementById("setOutput").textContent=`Displayed ${Math.min(100,g.size)} Builds / ${e.toLocaleString()} Combinations`}})(e.data.final.sets));let t=e.data.final.stats;for(let e=0;e<4;e++)r.remainingSlots[e]=w(r.remainingSlots[e]||0,t.remainingSlots[e]);for(let e=0;e<5;e++)r.quriousSkills[e]=w(r.quriousSkills[e]||0,t.quriousSkills[e]);for(const[e,s]of Object.entries(t.armorSkills))r.armorSkills[e]=w(r.armorSkills[e]||0,s);h||((e=>{let t="";e.forEach((e=>{0!=e[1]&&(t+=`<button textContent="${e[0]}">${e[0].replace(/(?<=[a-z])([A-Z])(?![A-Z])/g," $1")} +${+e[1]}</button>`)})),document.getElementById("temp")&&document.getElementById("temp").remove(),document.querySelector(".extraSkills").innerHTML+=t,document.getElementById("extraOutput").textContent=`Found ${p.toLocaleString()} Builds / ${c.toLocaleString()} Combinations`,window.location.href.includes("github")||(console.log((performance.now()-d)/1e3),console.log(g))})(((e=window.thisKey.types)=>{const{skills:t}=n(),{armorSkills:s,remainingSlots:o,quriousSkills:l}=r;for(let t=0;t<4;++t)if(o[t])for(const[l,i]of Object.entries(e.decoLevels[t]))s[l]=Math.max(s[l]||0,i*o[t]);Object.entries(e.qurious).forEach((([e,t])=>{l[t/3-1]&&(s[e]=Math.max(s[e]||0,l[t/3-1]))}));const i=[];return Object.entries(s).forEach((([s,o])=>{if(isNaN(s))if(t[s]+ +o>0&&e.maxLevel[s]>0){const l=(e.maxLevel[s]||window.thisKey.skills[s].length-1)+t[s];i.push([s,Math.min(+o,l)])}else t[s]||!e.maxLevel[s]&&!window.thisKey.skills[s]||i.push([s,Math.min(+o,e.maxLevel[s]||window.thisKey.skills[s].length-1)])})),i.sort()})()),c||(document.getElementById("setOutput").textContent="No Results Found",document.querySelectorAll(".grid>div").forEach((e=>e.remove()))))}))}))}const q=(e=10)=>{if((h||k)&&(d=performance.now(),m.length))for(let e of m)e.terminate();h=5,E();const t=n();t.charmSlots=window.thisKey[u.value].weapons[a.value].decos.slice(),document.querySelectorAll(".charmSlot").forEach((e=>{e.selectedIndex>0&&++t.charmSlots[e.selectedIndex-1]})),t.theseCharms={charms:{},charmSkills:{},skill1Names:[],skill2Names:[]};for(let e of Object.entries(t.skills))if(window.thisKey.charms[e[0]]){t.theseCharms.charmSkills[e[0]]=window.thisKey.charms[e[0]];for(let s=0;s<2;++s)(window.thisKey.charms[e[0]][s][0]<=-e[1]&&(!window.thisKey.types.qurious[e[0]]||!window.thisKey.types.decos[e[0]])||-e[1]>2-s&&window.thisKey.types.qurious[e[0]]>3)&&t.theseCharms[`skill${s+1}Names`].push(e[0])}t.armors=function(e,t,s){let o=JSON.parse(JSON.stringify(window.thisKey.armor));const l={helm:[],waist:[],chest:[],arm:[],leg:[]},n=[2.5,4.25,4.25,7];for(let e=0;e<5;++e)(0,i.VW)().forEach((e=>{o[e]=o[e].filter((e=>"MaleOnly"!==e.sex))}));return(0,i.VW)().forEach((i=>{o[i].forEach((o=>{if(!o)return;const r={},a=o.skills;if(13!==o.quriousTable){let e,t=-1;for(let[s,l]of Object.entries(o.decoAugments))++t,0==s||3===s&&t<2||(e=[+s,l[1]]);if(e){const[t,s]=e;r.decos=s,r.decoAugs=Object.keys(o.decoAugments),r.augs=[{"+Slots":-6*+t}],r.quriousPoints=o.quriousPoints-6*t}}else r.decos=[1,1,0,1],r.quriousPoints=0,r.augs=[{def:5},{def:5},{def:5},{def:5},{"+Slots":-18},{"+Slots":-12}];if(r.augs||(r.decos=o.decos,r.augs=[],r.quriousPoints=o.quriousPoints),e.StormSoul>3){const e=4===document.getElementById("StormSoul").selectedIndex?1:2;for(const s of a)t[s].qurious<6&&(a[s]+=e)}r.fodderSkills=[],r.fodderCount=0;let u=r.decos[0]*n[0]+r.decos[1]*n[1]+r.decos[2]*n[2]+r.decos[3]*n[3];for(const[s,l]of Object.entries(a))if(e[s])e[s]?((t.setBonus&&t?.setBonus[s]||t.charmNeeded&&t.charmNeeded[s])&&(u+=15*Math.min(-1*e[s],a[s])),u+=Math.min(-e[s],a[s])*(20===t[s].qurious?4:t[s].qurious/3)):13===o.quriousTable||r.fodderCount||(r.fodderCount=0);else{r.fodderCount+=l;for(let e=0;e<l;e++)r.fodderSkills.push(s)}if(13===o.quriousTable)r.unBloatedPoints=0,r.armorRating=u;else{let e=[],t=3;for(;t--;)r.augs[t]?e=e.concat(r.augs[0]):r.fodderCount-t>0?(e.push({"-Skill":r.fodderSkills.pop()}),r.quriousPoints+=10):(e.push({"-Def":5}),r.quriousPoints+=5);r.augs=e,r.unBloatedPoints=~~(r.quriousPoints/3),r.armorRating=u,r.armorRating=u+r.unBloatedPoints}let c=l[i].length;if(!(c===s&&l[i][--c].armorRating>=r.armorRating)){for(;c>0&&l[i][c-1].armorRating<r.armorRating;)l[i][c]=l[i][--c];l[i][c]=r,r.name=o.name,r.type=i,r.skills=o.skills}}))})),Object.values(l).forEach((t=>{t.forEach((t=>{t.skillLimitation=3-(5-Object.keys(t.skills).length),t.averageCostPerSkill=t.quriousPoints/3,t.needsRequestedSkill=t.skillLimitation>0,t.initAugs=t.augs,t.requestedSkills=Object.keys(t.skills).filter((t=>e[t])),t.skillsRemovedCount=t.fodderCount<3?t.fodderCount:3,t.startingQuriousPoints=t.quriousPoints,delete t.armorRating}))})),l}(t.skills,t.skillInfo,e),t.skillInfo={charmNeeded:t.skillInfo.charmNeeded,charmSkillPoints:t.skillInfo.charmSkillPoints,setBonus:t.skillInfo.setBonus,setLimiter:4-document.getElementById("skillsLimit").selectedIndex},t.skills=Object.entries(t.skills).sort(((e,t)=>window.thisKey.types.qurious[e[0]]-window.thisKey.types.qurious[t[0]]));let s=t.armors.waist.splice(0),o=~~(s.length/5);g.clear();for(const e of m)t.armors.waist=s.splice(0,o),e.postMessage(t);document.getElementById("setReturn").classList.remove("augInvis"),document.querySelectorAll(".extraSkills>button").forEach((e=>e.remove())),document.getElementById("temp")&&document.getElementById("temp").remove(),document.querySelector(".extraSkills").innerHTML+="<P2 id='temp' style='font-size:18px !important; height:15em !important;'>Searching...</P2>",document.getElementsByClassName("grid")[0].innerHTML="",r={remainingSlots:[0,0,0,0],armorSkills:{},quriousSkills:[0,0,0,0,0]},c=0,p=0};let v=0,b="";document.addEventListener("keypress",(e=>{e.key===["t","e","s","t"][Math.min(3,v)]&&++v<3||("Enter"===e.key&&v>=3?(I("f"!==b),b="",v=0):/t|f/.test(e.key)&&v>=3?b=e.key:v<3&&(v=0))})),document.addEventListener("keypress",(e=>{e.key===["b","u","i","l","d"][Math.min(5,f)]&&++f<5||("Enter"===e.key&&f>=5?(B(),f=0):f<5&&(f=0))}));const B=()=>{[["AdrenalineRush",3],["Bloodlust",3],["BloodRite",3],["Burst",3],["ChargeMaster",3],["Coalescence",1],["CriticalBoost",3],["CriticalElement",3],["Defiance",3],["DragonAttack",5],["ElementExploit",3],["Focus",2],["Frostcraft",3],["IntrepidHeart",2],["MailofHellfire",3],["MindsEye",3],["Partbreaker",3],["ProtectivePolish",3],["Slugger",1],["StunResistance",3],["WeaknessExploit",3],["WindMantle",1],["WirebugWhisperer",3]].forEach((e=>(0,l.Nb)(e[0],e[1]))),q(15),console.log(g)},I=(e=!0)=>([["PeakPerformance",3],["Coalescence",3],["CriticalEye",7],["CriticalBoost",3],["MaximumMight",3],["RecoilDown",3],["ReloadSpeed",3],["RapidFireUp",3],["PierceUp",3],["Burst",1],["Agitator",5],["AttackBoost",7],["AmmoUp",2],["SpareShot",3],["WeaknessExploit",3],["Tune-Up",1],["Bloodlust",1]].forEach((e=>(0,l.Nb)(e[0],e[1]))),q(15),g);document.getElementById("startSearch").addEventListener("click",(()=>q(10))),document.getElementById("normalSearch").addEventListener("click",(()=>q())),document.getElementById("extendedSearch").addEventListener("click",(()=>q(15))),document.querySelector(".grid").addEventListener("mousedown",(e=>{if("BUTTON"!==e.target.tagName)return;const t=Object.values(document.querySelectorAll("div.grid > div.setResult")).indexOf(e.target.parentElement);if(!g.has(t))return;const s=g.get(t);let i=e.target.parentElement.lastElementChild.selectedIndex,n=0;for(let e of s.usedSkills){if(i<e.charm.length)break;++n,i-=e.charm.length}let r=s.usedSkills[n],a=r.charm[i];if((0,o.dj)(a),0!==i){let e=Object.fromEntries(r.charm[0]);for(let t=0;t<2;++t)if(e[a[t][0]]){let s=Math.min(e[a[t][0]],a[t][1]);e[a[t][0]]-=s,a[t][1]-=s}for(let t=0;t<2;++t){let[s,o]=a[t];if(o)for(let l of r.decos)if(!(l[0]!==s||l[1]>o))for(let s in e)if((window.thisKey.types.pointsPerSlot[l[2][8]-1][s]===l[1]||window.thisKey.types.pointsPerSlot[l[2][8]-1][s]<l[1]&&window.thisKey.types.decos[s]<=window.thisKey.types.decos[l[0]])&&e[s]>=l[1]){let i=l[1]*l[3];if(i<=e[s])l[0]=s,e[s]-=i,a[t][1]-=i;else{let i=Math.min(e[s],~~(o/l[1]));l[3]-=i,r.decos.push([s,l[1],l[2],i]),e[s]-=i,a[t][1]-=i}}}for(let t=0;t<2;++t){let[s,o]=a[t];if(!o)continue;let l=[];for(let e of Object.values(r.augments))l.push(...e.augs);for(;o-- >0;){let o=l.find((e=>e["-Skill"]===s));if(o){for(let s in e)if(e[s]>0){o["-Skill"]=s,--e[s],--a[t][1];break}}else console.log("error finding augment to replace")}}}(0,o.qy)(r.augments),(0,o.Cj)((0,o.G_)(r.decos)),document.getElementById("setReturn").classList.add("augInvis"),(0,l.TG)(),document.querySelectorAll(".extraSkills>button").forEach((e=>e.remove())),document.querySelectorAll(".grid>div").forEach((e=>e.remove())),(0,o.to)(),(0,l.TG)(),k&&console.log(JSON.parse(JSON.stringify(r))),g.clear()}))}}]);