(()=>{var t={382:(t,e,n)=>{n.d(e,{p:()=>i});const i=(t,e,n={})=>{const{charmSkills:i,skill1Names:r,skill2Names:u}=t;for(let t of r){let[r,f,a,c]=l(t,i[t][0]);for(let d of u){if(t===d)continue;let u,g,k,[h,m,P,S]=l(d,i[d][1]);"charmNeeded"===f||"charmNeeded"===m?(g="charmNeeded"===f&&"charmNeeded"===m?[a,P]:"charmNeeded"===f?a:P,u="charmNeeded"):(g=a+P,u="deco"===f||"deco"===m?"deco":"qurious"===f||"qurious"===m?"qurious":"standard"),k=o(c,S),n[u]||(n[u]={}),s(n[u],g,k,[[t,r,e.get(t)],[d,h,e.get(d)]])}}for(let t in n)n[t]=Object.entries(n[t]).sort(((t,e)=>e[0]-t[0])).map((t=>Object.values(t[1]).reverse()));return Object.values(n)};function o(t,e){let n="";for(let i=0;i<5;++i)n+=t[i]+e[i];return n}function l(t,e){let[n,i,o]=e,l=i?i[0]?o?"standard":"qurious":"deco":"charmNeeded";return"charmNeeded"===l?[n,l,t,[0,0,0,0,n]]:(i[4]="standard"===l?0:o,[n,l,o,i])}function s(t,e,n,i){t[n]||(t[n]={}),t[n][e]||(t[n][e]=[]),t[n][e].push(i)}},166:(t,e,n)=>{var i=n(382);const o=[0,1,2,3,4],l=new Map,s=[],r=[];let u=[];const f=["",{total:1,skills:[]},{total:2,skills:[]},{total:1,skills:[]},{total:1,skills:[]},{total:3,skills:[]}],a={armors:{},indexByType:{waist:3,chest:1,helm:0,leg:4,arm:2},setNextArmor(t,e,n){if(t)for(let e of t.requestedSkills)l.get(e)[3]+=t.skills[e];for(let n=0;n<4;++n)r[n]+=(-t?.decos[n]||0)+e.decos[n];s[this.indexByType[e.type]]=e;for(let t of e.requestedSkills)(l.get(t)[3]-=e.skills[t])<l.get(t)[6]&&(n=l.get(t));return n},resetArmors(){for(const t of s)t.augs[1]!==t.initAugs[1]&&(t.augs[1]=t.initAugs[1]),t.augs[2]!==t.initAugs[2]&&(t.augs[2]=t.initAugs[2]),t.augsPointer=3,t.skillLen=t.len,t.skillsRemovedCount=-1,t.quriousPoints=t.startingQuriousPoints,t.unBloatedPoints=c[t.startingQuriousPoints]},findSkillsStillNeeded(t){let e=t.requestedSkills.length;for(;e--;)if(l.get(t.requestedSkills[e])[0]>0)return l.get(t.requestedSkills[e])},addSkillToSet(t,e){let n=e.skillLen;for(;n--;)if(e.innateSkills[n]===t)return!0;if(e.skillLen<5)return e.innateSkills[e.skillLen]=t,++e.skillLen,!0}},c=[];for(let t=0,e=0;t<50;t++)!t||t%3||++e,c[t]=e;const d=(t,e)=>t>=e?t:e,g=(t,e)=>t<=e?t:e;let k={};function h(t,e,n){let i=t.length,l=function(t){let e={2:0,3:0,4:0},n=5;for(;n--&&t;){let i=s[o[n]],l=i.decoAugs;if(!l)continue;let r=l.length;for(;--r&&t;){let n=l[r][0]-l[r-1][0],o=l[r][1][1][0]!==l[r-1][1][1][0];if(l[r-1][1][0]<4||n>2||o)break;2===n?++e[2]:++e[3],m(i),--t}}return e[4]+=t,e}(e);t:for(;i--&&e;){let o=f[t[i]];for(let s=0;s<o.skills.length&&e;s++){const r=o.skills[s];let u=r[5];for(;u<5&&r[0]&&e;){if(!l[u]){++u;continue}let f=g(l[u],r[0]);if(l[u]-=f,e-=f,r[0]-=f,n.push([r[1],u,f]),0==(o.total-=f)){t.splice(i,1),--i;continue t}r[0]||(o.skills[s]=o.skills[o.skills.length-1],o.skills.pop(),--s)}}}return e}function m(t){let e=t.decoAugs,n=e.length,i=6*(e[n-1][0]-e[n-2][0]);2===e.length?B(t,2):t.augs[2]={"+Slots":-6*e[n-2][0]},t.quriousPoints+=i,t.unBloatedPoints=c[t.quriousPoints]}function P(t,e,n,i){const l=[];let r,d=0,g=5*n,k=6,m=[],P=i;t:for(;P--;){m=u[P];let n=m[3];if(n<=0){m[0]=m[3];continue t}let i=m[4],o=i.length;e:for(;o--;){let l=i[o],s=l[1],r=t[s-1];if(!r)continue e;let u=l[0];if(n<u)continue e;let f=Math.min(r,~~(n/u));if(n-=f*u,t[s-1]-=f,e[e.length]=[m[1],u,s,f],!n){m[0]=0;continue t}}if(m[0]=n,(d+=n)-t[3]>g)return!0;if(k===m[2])r.total+=n,r.skills[r.skills.length]=m;else{if(k=m[2],!k)return!0;r=f[k],l[l.length]=k,r.total=n,r.skills=[m]}}if(!l.length)return l.length;if(g-=d,a.resetArmors(),t[3]){let n=h(l,t[3],e);if(0==(d-=t[3]+n))return l.length;t=n}l.reverse();t:for(let t of o){const e=s[t];if(d<=0||g<0)return l.length;if(e.len<=2&&3*l[l.length-1]<=e.unBloatedPoints){let t=Math.min(3,d,n);for(;t--&&d;){if(y(f[l[l.length-1]].skills[0],e,l))return l.length;if(0==--d)return l.length}continue t}let i,o=3,r=5-e.skillLen,u=Math.min(o,n),c=o-d;for(;(--c>=0||!v(l,u,e.unBloatedPoints))&&--u;){if(c<0&&--g<0)return l.length;B(e)}if(u&&!(g<0)){if(u>r){let t=a.findSkillsStillNeeded(e);for(;t&&r<u&&t[0]>0&&v(l,u-1,e.unBloatedPoints-t[2],t[2]);){if(y(t,e,l))continue t;if(--u,0==--d)return l.length}}if(u>r)for(;u>r;){if(i=1===r?b(u,e.unBloatedPoints,l):b(u-1,e.unBloatedPoints-l[0],l),i){if(y(i[0],e,l,i[1]))continue t;if(0==(d-=i[1]))return l.length;u-=i[1];break}if(--g<0)return l.length;if(0==--u)continue t;B(e)}if(u){i=2===u?p(l,e.unBloatedPoints):3===u?S(l,e.unBloatedPoints):q(l,e.unBloatedPoints);for(const t of i){if(y(f[t].skills[0],e,l))continue t;if(0==--d)return l.length}}}}return l.length&&4===n&&(d=function(t,e){for(const n of s){if(!t||!e.length)break;let i=n.augsPointer;if(i<6&&n.unBloatedPoints<e[0]||6===i&&n.quriousPoints<5+3*e[0])continue;let o=0,l=0;for(let t=0;t<i;++t){let e=n.augs[t];e["-Def"]?o=t:e["-Skill"]&&(l=t)}let s,r=6-n.augsPointer?0:o?5:l?10:"continue";if("continue"===r||c[n.quriousPoints-r]<e[0])continue;let u=e.length;t:for(;u--;)if(!(n.quriousPoints-r<3*e[u]))for(let t of f[e[u]].skills)if(a.addSkillToSet(t[1],n)){s=t;break t}if(s&&(r&&(n.quriousPoints-=r,n.unBloatedPoints=c[n.quriousPoints],n.augs.splice(o-1||l-1,1),--n.augsPointer),!y(s,n,e)&&0==--t))return}return t}(d,l)),l.length}function S(t,e){let n=t.length,i=n;for(;i--;){if(3*t[i]>e)continue;let o=n;for(;--o>=i;){if(i!==o&&t[i]+2*t[o]>e||i===o&&1===f[t[i]].total)continue;let l=n;for(;--l>=o;)if((o===l||t[i]+t[o]+t[l]<=e)&&f[t[l]].total>(l===i)+(l===o))return[t[i],t[o],t[l]]}}}function p(t,e){let n=t.length,i=n;for(;i--;){if(2*t[i]>e)continue;let o=n;for(;--o>=i;)if(t[i]+t[o]<=e&&(i!==o||f[t[i]].total>1))return[t[i],t[o]]}}function q(t,e){for(let n=t.length-1;n>=0;--n)if(t[n]<=e)return[t[n]]}function b(t,e,n){let i=n.length;for(;i--;){let o=f[n[i]];if(!(!o||n[i]*t>e||o.total-o.skills.length<t))for(let e of o.skills)if(e[0]>=t)return[e,t]}}function B(t,e){e||(e=t.augsPointer,6!==t.augsPointer&&++t.augsPointer);let n=t.fodderSkills[++t.skillsRemovedCount];n?(t.augs[e]={"-Skill":n},t.quriousPoints+=10):(t.augs[e]={"-Def":5},t.quriousPoints+=5),t.unBloatedPoints=~~(t.quriousPoints/3)}function v(t,e,n,i=0){if(t[0]*e<=n){let o=0;for(;n>=0;){let l=t[o],s=f[l].total-(i==l);if(!(e-s>0))return n-l*e>=0;n-=l*s,e-=s,++o}}}function y(t,e,n,i=1){let[,o,l]=t;if(!a.addSkillToSet(o,e)||e.unBloatedPoints<l*i||e.augsPointer+i>6)return!0;for(e.quriousPoints-=3*l*i,e.unBloatedPoints-=l*i,t[0]-=i,f[l].total-=i;i--;)e.augs[e.augsPointer]={"+Skill":o},6!==e.augsPointer&&++e.augsPointer;if(0===f[l].total)return void n.splice(n.indexOf(l),1);if(t[0])return;let s=f[l].skills;for(let t=0,e=s.length-1;t<e;++t)if(s[t][1]===o){s[t]=s[e];break}s.pop()}function N(t,e){let n={decos:t.decos.slice(),charm:e,augments:{}};for(let t of s)n.augments[t.type]={augs:t.augs.slice(0,t.augsPointer),name:t.name,type:t.type};return n}function A(t,e,n){if(!n[0])return t;let i=[0,0,0,0],o=e.length,s=n[3],r=n[2]-s;if(r)for(;o--;){let[t,s,u,f]=e[o];const a=l.get(t)[2]-1;if(a>3)break;if(n[a]<s)continue;let c=g(~~(r/s),f);i[u-1]<c&&(i[u-1]=c)}for(let e=0;e<4;++e)i[e]+=t[e];return s&&(i[3]+=~~((s+i[1]+i[2])/2),i[1]+=s,i[2]+=s-s%2),i}function x(){const t=[0,0,0,0,0];for(let e of s){if(e.quriousPoints<(6===e.augsPointer?8:3)||e.skillLen>4)continue;let n=0,i=0;for(let t of e.augs)t["-Def"]?++n:t["-Skill"]&&++i;let o=6-e.augsPointer,l=--o>=0?0:--n>=0?5:--i>=0?10:"continue";if("continue"===l)continue;let s=1;for(;e.quriousPoints>=l+3*s;){let r=g(5,c[~~((e.quriousPoints-l)/s)]);for(;r--;)++t[r];if(l+=--o>=0?0:--n>=0?5:--i>=0?10:"continue","continue"===l)break;++s}}return t}function L(){const t={};for(let e of s){if(!e.fodderCount||e.quriousPoints<5&&6===e.augsPointer)continue;const n=e.fodderCount-(e.skillsRemovedCount+3),i=6-e.augsPointer+g(~~(e.quriousPoints/5),e.fodderCount-n)+n;if(i)for(let n in e.skills){if(l.has(n))continue;let o=7;o<=0||(t[n]=(t[n]||0)+Math.min(e.skills[n],i,o))}}return t}function O(t,e){for(let n=0;n<4;n++)e.remainingSlots[n]=d(e.remainingSlots[n]||0,t.remainingSlots[n]);for(let n=0;n<5;n++)e.quriousSkills[n]=d(e.quriousSkills[n]||0,t.quriousSkills[n]);for(const[n,i]of Object.entries(t.armorSkills))e.armorSkills[n]=d(e.armorSkills[n]||0,i)}"undefined"!=typeof self&&(self.onmessage=t=>{a.armors=t.data.armors,u=t.data.skills.reverse();for(const t of u)l.set(t[1],t);k={sets:[{}],count:{sets:0,combos:0},stats:{quriousSkills:[0,0,0,0,0],armorSkills:{},remainingSlots:[0,0,0,0]},name:self.name};for(let e=0;e<4;++e)r[e]=t.data.charmSlots[e];const{theseCharms:e,skillInfo:n}=t.data;!function(t,e){let n=k.sets[0];const{setLimiter:f,setBonus:c,canPrune:d}=e,g=(0,i.p)(t,l),h={augments:s,decos:[]},m=["arm","leg","helm","chest","waist"];let S=[];for(let t=0;t<5;++t)S[t]=[-1,a.armors[m[t]].length,m[t]];let p,q,b=[0,0,0,0],B=0;const v=u.length;t:for(;;){q&&(q[0][2][3]+=q[0][1],q[1][2][3]+=q[1][1]),q=!1;for(let t of S){let e=s[a.indexByType[t[2]]],n=0;if(B&&e?.skills[B[1]]&&(n=e.skills[B[1]]),(++t[0]===t[1]||B&&!n)&&(t[0]=0,"waist"===t[2]&&e))break t;if(n&&B[2]+n>=0&&(B=!1),B=a.setNextArmor(e,a.armors[t[2]][t[0]],B),0!==t[0])break}if(B)continue t;if(c)for(let t in c)if(l.get(t)[3]-c[t]>0)continue t;o.sort(((t,e)=>s[e].len-s[t].len||s[t].unBloatedPoints-s[e].unBloatedPoints)),n.count=0;let t={i3:-1,i2:-1,i1:-1};for(t.len3=g.length;;){if(++t.i1===t.len1||0===t.i1){if(t.i1=0,++t.i2===t.len2||0===t.i2){if(t.i2=0,++t.i3>=t.len3)break;t.data2=g[t.i3],t.len2=t.data2.length}t.data1=t.data2[t.i2],t.len1=t.data1.length}for(let e=0,i=t.data1[t.i1].length;e<i;e++)if(q&&(q[0][2][3]+=q[0][1],q[1][2][3]+=q[1][1]),q=t.data1[t.i1][e],p=((q[0][2][3]-=q[0][1])<0)+((q[1][2][3]-=q[1][1])<0),!(2===p||d&&p)){for(let t=0;t<4;++t)b[t]=r[t];if(h.decos=[],P(b,h.decos,f,v)){if(!d||p)continue;break}n.count||(n.quriousSkills=x(),n.armorSkills=L(),n.usedSkills=[],n.count=0,n.decoArr=r.slice(),n.remainingSlots=A(b,h.decos,n.quriousSkills)),n.usedSkills.push(N(h,q)),++n.count}}if(!n.count)continue t;++k.count.sets,k.count.combos+=n.count,O(n,k.stats);let e=k.sets.length-1;if(!(21===e&&k.sets[--e].count>=n.count)){for(;e>0&&k.sets[e-1].count<n.count;)k.sets[e]=k.sets[--e];k.sets[e]=n,k.sets.length<21&&k.sets.push({}),n=k.sets[k.sets.length-1]}}}(e,n),k.sets.pop(),postMessage({final:k}),self.location.href.includes("GitHub")&&self.close()})}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var l=e[i]={exports:{}};return t[i](l,l.exports,n),l.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n(166);n(382)})();