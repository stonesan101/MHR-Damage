(()=>{"use strict";const e=JSON.parse('{"decos":{"AffinitySliding":1,"BlastResistance":1,"Bombardier":1,"Botanist":1,"CarvingPro":1,"ChameleosBlessing":1,"DefenseBoost":1,"Defiance":1,"Diversion":1,"DragonAttack":1,"DragonResistance":1,"FireAttack":1,"FireResistance":1,"FlinchFree":1,"FreeMeal":1,"Geologist":1,"HornMaestro":1,"HungerResistance":1,"IceAttack":1,"IceResistance":1,"IntrepidHeart":1,"KushalaBlessing":1,"LeapofFaith":1,"MuckResistance":1,"ParalysisResistance":1,"PoisonAttack":1,"PoisonResistance":1,"RecoilDown":1,"RecoverySpeed":1,"ReloadSpeed":1,"ShockAbsorber":1,"SleepResistance":1,"SpeedSharpening":1,"SpiribirdsCall":1,"StaminaThief":1,"Steadiness":1,"StunResistance":1,"TeostraBlessing":1,"ThunderAttack":1,"ThunderResistance":1,"WallRunner Boost":1,"WaterAttack":1,"WaterResistance":1,"Windproof":1,"AdrenalineRush":2,"Agitator":2,"Artillery":2,"AttackBoost":2,"Ballistics":2,"BladescaleHone":2,"BlastAttack":2,"BlightResistance":2,"Bludgeoner":2,"BubblyDance":2,"Burst":2,"ChargeMaster":2,"Coalescence":2,"Constitution":2,"Counterstrike":2,"CriticalBoost":2,"CriticalElement":2,"CriticalEye":2,"DivineBlessing":2,"ElementExploit":2,"Embolden":2,"EvadeExtender":2,"EvadeWindow":2,"Focus":2,"Foray":2,"Fortify":2,"Guard":2,"GuardUp":2,"Heroics":2,"ItemProlonger":2,"LatentPower":2,"LoadShells":2,"MarathonRunner":2,"MasterMounter":2,"MastersTouch":2,"MaximumMight":2,"MindsEye":2,"ParalysisAttack":2,"Partbreaker":2,"PeakPerformance":2,"PowerProlonger":2,"ProtectivePolish":2,"PunishingDraw":2,"QuickSheathe":2,"RapidMorph":2,"RazorSharp":2,"RecoveryUp":2,"Resentment":2,"Resuscitate":2,"SleepAttack":2,"Slugger":2,"SneakAttack":2,"SpareShot":2,"SpecialAmmoBoost":2,"SpeedEating":2,"StaminaSurge":2,"TremorResistance":2,"WallRunner":2,"WeaknessExploit":2,"Wide-Range":2,"WirebugWhisperer":2,"AmmoUp":3,"BloodRite":3,"CriticalDraw":3,"Earplugs":3,"GoodLuck":3,"Grinder S":3,"Handicraft":3,"HellfireCloak":3,"JumpMaster":3,"Mushroomancer":3,"Normal RapidUp":3,"OffensiveGuard":3,"PierceUp":3,"QuickBreath":3,"RapidFireUp":3,"Redirection":3,"SpreadUp":3,"StatusTrigger":3,"Tune-Up":3,"Bloodlust":4,"BowChargePlus":4,"Dragonheart":4},"maxLevel":{"AttackBoost":7,"Agitator":5,"PeakPerformance":3,"Resentment":5,"Resuscitate":3,"CriticalEye":7,"CriticalBoost":3,"WeaknessExploit":3,"LatentPower":5,"MaximumMight":3,"CriticalElement":3,"MastersTouch":3,"FireAttack":5,"WaterAttack":5,"IceAttack":5,"ThunderAttack":5,"DragonAttack":5,"PoisonAttack":3,"ParalysisAttack":3,"SleepAttack":3,"BlastAttack":3,"Handicraft":5,"RazorSharp":3,"SpareShot":3,"ProtectivePolish":3,"MindsEye":3,"Ballistics":3,"Bludgeoner":3,"BowChargePlus":1,"Focus":3,"PowerProlonger":3,"MarathonRunner":3,"Constitution":5,"StaminaSurge":3,"Guard":5,"GuardUp":3,"OffensiveGuard":3,"CriticalDraw":3,"PunishingDraw":3,"QuickSheathe":3,"Slugger":3,"StaminaThief":3,"AffinitySliding":1,"HornMaestro":1,"Artillery":3,"LoadShells":2,"SpecialAmmoBoost":2,"Normal RapidUp":3,"PierceUp":3,"SpreadUp":3,"AmmoUp":3,"ReloadSpeed":3,"RecoilDown":3,"Steadiness":3,"RapidFireUp":3,"DefenseBoost":7,"DivineBlessing":3,"RecoveryUp":3,"RecoverySpeed":3,"SpeedEating":3,"Earplugs":5,"Windproof":3,"TremorResistance":3,"BubblyDance":3,"EvadeWindow":5,"EvadeExtender":3,"FireResistance":3,"WaterResistance":3,"IceResistance":3,"ThunderResistance":3,"DragonResistance":3,"BlightResistance":3,"PoisonResistance":3,"ParalysisResistance":3,"SleepResistance":3,"StunResistance":3,"MuckResistance":2,"BlastResistance":3,"Botanist":4,"Geologist":3,"Partbreaker":3,"CaptureMaster":1,"CarvingMaster":1,"GoodLuck":3,"SpeedSharpening":3,"Bombardier":3,"Mushroomancer":3,"ItemProlonger":3,"Wide-Range":5,"FreeMeal":3,"Heroics":5,"Fortify":1,"FlinchFree":3,"JumpMaster":1,"CarvingPro":1,"HungerResistance":3,"LeapofFaith":1,"Diversion":1,"MasterMounter":1,"ChameleosBlessing":4,"KushalaBlessing":4,"TeostraBlessing":4,"Dragonheart":5,"WirebugWhisperer":3,"WallRunner":3,"Counterstrike":3,"RapidMorph":3,"HellfireCloak":4,"WindAlignment":5,"ThunderAlignment":5,"Stormsoul":5,"BloodRite":3,"Dereliction":3,"Furious":3,"MailofHellfire":3,"Coalescence":3,"Bloodlust":3,"Defiance":5,"SneakAttack":3,"AdrenalineRush":3,"Redirection":2,"SpiribirdsCall":1,"ChargeMaster":3,"Foray":3,"Tune-Up":2,"Grinder S":3,"BladescaleHone":3,"WallRunner Boost":1,"QuickBreath":1,"ElementExploit":3,"Burst":3,"Guts":3,"StatusTrigger":3,"IntrepidHeart":2,"BuildupBoost":3,"Embolden":3,"WindMantle":3,"PowderMantle":3,"Berserk":2,"Strife":3,"Frostcraft":3,"DragonConversion":3,"Heaven-Sent":3,"FrenziedBloodlust":3,"ShockAbsorber":1},"qurious":{"AmmoUp":15,"AttackBoost":15,"CriticalBoost":15,"CriticalEye":15,"Guts":15,"MastersTouch":15,"Normal RapidUp":15,"PierceUp":15,"RapidFireUp":15,"RazorSharp":15,"SpareShot":15,"SpreadUp":15,"WeaknessExploit":15,"Agitator":12,"Artillery":12,"BloodRite":12,"Bloodlust":12,"BuildupBoost":12,"Burst":12,"Coalescence":12,"DragonConversion":12,"Frostcraft":12,"GoodLuck":12,"Handicraft":12,"LatentPower":12,"MaximumMight":12,"PeakPerformance":12,"RapidMorph":12,"Resentment":12,"Resuscitate":12,"SneakAttack":12,"Tune-Up":12,"AdrenalineRush":9,"Ballistics":9,"BladescaleHone":9,"ChargeMaster":9,"CriticalDraw":9,"CriticalElement":9,"Dragonheart":9,"Earplugs":9,"ElementExploit":9,"Focus":9,"Foray":9,"Furious":9,"Grinder S":9,"HellfireCloak":9,"Heroics":9,"MailofHellfire":9,"MindsEye":9,"Mushroomancer":9,"OffensiveGuard":9,"PowderMantle":9,"PowerProlonger":9,"ProtectivePolish":9,"Redirection":9,"StatusTrigger":9,"Strife":9,"WindMantle":9,"WirebugWhisperer":9,"BlastAttack":6,"BubblyDance":6,"ChameleosBlessing":6,"Constitution":6,"Counterstrike":6,"Defiance":6,"Embolden":6,"EvadeExtender":6,"EvadeWindow":6,"Guard":6,"GuardUp":6,"IntrepidHeart":6,"KushalaBlessing":6,"LoadShells":6,"MarathonRunner":6,"ParalysisAttack":6,"Partbreaker":6,"PoisonAttack":6,"PunishingDraw":6,"QuickSheathe":6,"RecoilDown":6,"ReloadSpeed":6,"SleepAttack":6,"Slugger":6,"SpecialAmmoBoost":6,"SpeedEating":6,"StaminaSurge":6,"Steadiness":6,"TeostraBlessing":6,"TremorResistance":6,"WallRunner":6,"AffinitySliding":3,"BlastResistance":3,"BlightResistance":3,"DefenseBoost":3,"Diversion":3,"DivineBlessing":3,"DragonAttack":3,"FireAttack":3,"FlinchFree":3,"Fortify":3,"FreeMeal":3,"HornMaestro":3,"HungerResistance":3,"IceAttack":3,"ItemProlonger":3,"LeapofFaith":3,"MasterMounter":3,"MuckResistance":3,"ParalysisResistance":3,"PoisonResistance":3,"RecoverySpeed":3,"RecoveryUp":3,"SleepResistance":3,"SpeedSharpening":3,"SpiribirdsCall":3,"StaminaThief":3,"StunResistance":3,"ThunderAttack":3,"WallRunner Boost":3,"WaterAttack":3,"Wide-Range":3,"Windproof":3},"pointsPerSlot":[{"Bombardier":1,"Botanist":1,"CarvingPro":1,"DragonResistance":1,"FireResistance":1,"Geologist":1,"IceResistance":1,"ShockAbsorber":1,"ThunderResistance":1,"WaterResistance":1,"ChameleosBlessing":1,"Defiance":1,"IntrepidHeart":1,"KushalaBlessing":1,"PoisonAttack":1,"RecoilDown":1,"ReloadSpeed":1,"Steadiness":1,"TeostraBlessing":1,"AffinitySliding":1,"BlastResistance":1,"DefenseBoost":1,"Diversion":1,"DragonAttack":1,"FireAttack":1,"FlinchFree":1,"FreeMeal":1,"HornMaestro":1,"HungerResistance":1,"IceAttack":1,"LeapofFaith":1,"MuckResistance":1,"ParalysisResistance":1,"PoisonResistance":1,"RecoverySpeed":1,"SleepResistance":1,"SpeedSharpening":1,"SpiribirdsCall":1,"StaminaThief":1,"StunResistance":1,"ThunderAttack":1,"WallRunner Boost":1,"WaterAttack":1,"Windproof":1},{"Bludgeoner":1,"AttackBoost":1,"CriticalBoost":1,"CriticalEye":1,"MastersTouch":1,"RazorSharp":1,"SpareShot":1,"WeaknessExploit":1,"Agitator":1,"Artillery":1,"Burst":1,"Coalescence":1,"LatentPower":1,"MaximumMight":1,"PeakPerformance":1,"RapidMorph":1,"Resentment":1,"Resuscitate":1,"SneakAttack":1,"AdrenalineRush":1,"Ballistics":1,"BladescaleHone":1,"ChargeMaster":1,"CriticalElement":1,"ElementExploit":1,"Focus":1,"Foray":1,"Heroics":1,"MindsEye":1,"PowerProlonger":1,"ProtectivePolish":1,"WirebugWhisperer":1,"BlastAttack":1,"BubblyDance":1,"Constitution":1,"Counterstrike":1,"Embolden":1,"EvadeExtender":1,"EvadeWindow":1,"Guard":1,"GuardUp":1,"LoadShells":1,"MarathonRunner":1,"ParalysisAttack":1,"Partbreaker":1,"PunishingDraw":1,"QuickSheathe":1,"SleepAttack":1,"Slugger":1,"SpecialAmmoBoost":1,"SpeedEating":1,"StaminaSurge":1,"TremorResistance":1,"WallRunner":1,"ChameleosBlessing":1,"Defiance":1,"IntrepidHeart":1,"KushalaBlessing":1,"PoisonAttack":1,"RecoilDown":1,"ReloadSpeed":1,"Steadiness":1,"TeostraBlessing":1,"DefenseBoost":2,"DragonAttack":2,"FireAttack":2,"IceAttack":2,"ThunderAttack":2,"WaterAttack":2,"BlightResistance":1,"DivineBlessing":1,"Fortify":1,"ItemProlonger":1,"MasterMounter":1,"RecoveryUp":1,"Wide-Range":1,"AffinitySliding":1,"BlastResistance":1,"Diversion":1,"FlinchFree":1,"FreeMeal":1,"HornMaestro":1,"HungerResistance":1,"LeapofFaith":1,"MuckResistance":1,"ParalysisResistance":1,"PoisonResistance":1,"RecoverySpeed":1,"SleepResistance":1,"SpeedSharpening":1,"SpiribirdsCall":1,"StaminaThief":1,"StunResistance":1,"WallRunner Boost":1,"Windproof":1},{"JumpMaster":1,"QuickBreath":1,"AmmoUp":1,"Normal RapidUp":1,"PierceUp":1,"RapidFireUp":1,"SpreadUp":1,"AttackBoost":1,"CriticalBoost":1,"CriticalEye":1,"MastersTouch":1,"RazorSharp":1,"SpareShot":1,"WeaknessExploit":1,"BloodRite":1,"GoodLuck":1,"Handicraft":1,"Tune-Up":1,"Agitator":1,"Artillery":1,"Burst":1,"Coalescence":1,"LatentPower":1,"MaximumMight":1,"PeakPerformance":1,"RapidMorph":1,"Resentment":1,"Resuscitate":1,"SneakAttack":1,"Guard":2,"IntrepidHeart":2,"CriticalDraw":1,"Earplugs":1,"Grinder S":1,"HellfireCloak":1,"Mushroomancer":1,"OffensiveGuard":1,"Redirection":1,"StatusTrigger":1,"AdrenalineRush":1,"Ballistics":1,"BladescaleHone":1,"ChargeMaster":1,"CriticalElement":1,"ElementExploit":1,"Focus":1,"Foray":1,"Heroics":1,"MindsEye":1,"PowerProlonger":1,"ProtectivePolish":1,"WirebugWhisperer":1,"DefenseBoost":3,"DragonAttack":3,"FireAttack":3,"IceAttack":3,"ThunderAttack":3,"WaterAttack":3,"Wide-Range":3,"ChameleosBlessing":1,"Defiance":1,"KushalaBlessing":1,"PoisonAttack":1,"RecoilDown":1,"ReloadSpeed":1,"Steadiness":1,"TeostraBlessing":1,"BlastAttack":1,"BubblyDance":1,"Constitution":1,"Counterstrike":1,"Embolden":1,"EvadeExtender":1,"EvadeWindow":1,"GuardUp":1,"LoadShells":1,"MarathonRunner":1,"ParalysisAttack":1,"Partbreaker":1,"PunishingDraw":1,"QuickSheathe":1,"SleepAttack":1,"Slugger":1,"SpecialAmmoBoost":1,"SpeedEating":1,"StaminaSurge":1,"TremorResistance":1,"WallRunner":1,"AffinitySliding":1,"BlastResistance":1,"Diversion":1,"FlinchFree":1,"FreeMeal":1,"HornMaestro":1,"HungerResistance":1,"LeapofFaith":1,"MuckResistance":1,"ParalysisResistance":1,"PoisonResistance":1,"RecoverySpeed":1,"SleepResistance":1,"SpeedSharpening":1,"SpiribirdsCall":1,"StaminaThief":1,"StunResistance":1,"WallRunner Boost":1,"Windproof":1,"BlightResistance":1,"DivineBlessing":1,"Fortify":1,"ItemProlonger":1,"MasterMounter":1,"RecoveryUp":1},{"BowChargePlus":1,"AmmoUp":2,"AttackBoost":2,"CriticalEye":2,"MastersTouch":2,"Normal RapidUp":2,"PierceUp":2,"RazorSharp":2,"SpreadUp":2,"Agitator":2,"Artillery":2,"Burst":2,"Coalescence":2,"GoodLuck":2,"Handicraft":2,"LatentPower":2,"MaximumMight":2,"PeakPerformance":2,"RapidMorph":2,"Resentment":2,"Resuscitate":2,"SneakAttack":2,"Tune-Up":2,"AdrenalineRush":2,"Ballistics":2,"BladescaleHone":2,"ChargeMaster":2,"CriticalDraw":2,"CriticalElement":2,"Earplugs":2,"ElementExploit":2,"Focus":2,"Foray":2,"Grinder S":2,"HellfireCloak":2,"Heroics":2,"MindsEye":2,"Mushroomancer":2,"OffensiveGuard":2,"PowerProlonger":2,"ProtectivePolish":2,"Redirection":2,"StatusTrigger":2,"WirebugWhisperer":2,"Defiance":3,"PoisonAttack":3,"Steadiness":2,"WallRunner":3,"CriticalBoost":1,"SpareShot":1,"WeaknessExploit":1,"RapidFireUp":1,"DefenseBoost":5,"Bloodlust":1,"BloodRite":1,"BlastAttack":2,"BubblyDance":2,"Constitution":2,"Counterstrike":2,"Embolden":2,"EvadeExtender":2,"EvadeWindow":2,"GuardUp":2,"LoadShells":2,"MarathonRunner":2,"ParalysisAttack":2,"Partbreaker":2,"PunishingDraw":2,"QuickSheathe":2,"SleepAttack":2,"Slugger":2,"SpecialAmmoBoost":2,"SpeedEating":2,"StaminaSurge":2,"TremorResistance":2,"IntrepidHeart":2,"Guard":2,"DragonAttack":4,"FireAttack":4,"IceAttack":4,"ThunderAttack":4,"WaterAttack":4,"Wide-Range":4,"Dragonheart":1,"BlastResistance":3,"FlinchFree":3,"FreeMeal":3,"HungerResistance":3,"ItemProlonger":3,"ParalysisResistance":3,"PoisonResistance":3,"RecoverySpeed":3,"SleepResistance":3,"SpeedSharpening":3,"StaminaThief":3,"StunResistance":3,"Windproof":3,"ChameleosBlessing":1,"KushalaBlessing":1,"RecoilDown":1,"ReloadSpeed":1,"TeostraBlessing":1,"BlightResistance":2,"DivineBlessing":2,"RecoveryUp":2,"AffinitySliding":1,"Diversion":1,"HornMaestro":1,"LeapofFaith":1,"MuckResistance":1,"SpiribirdsCall":1,"WallRunner Boost":1,"Fortify":1,"MasterMounter":1}],"lvl4":{"AttackBoost":2,"Agitator":2,"PeakPerformance":2,"Resentment":2,"Resuscitate":2,"CriticalEye":2,"CriticalBoost":null,"WeaknessExploit":null,"LatentPower":2,"MaximumMight":2,"CriticalElement":2,"MastersTouch":2,"FireAttack":4,"WaterAttack":4,"IceAttack":4,"ThunderAttack":4,"DragonAttack":4,"PoisonAttack":3,"ParalysisAttack":2,"SleepAttack":2,"BlastAttack":2,"Handicraft":2,"RazorSharp":2,"SpareShot":null,"ProtectivePolish":2,"MindsEye":2,"Ballistics":2,"Bludgeoner":null,"BowChargePlus":1,"Focus":2,"PowerProlonger":2,"MarathonRunner":2,"Constitution":2,"StaminaSurge":2,"Guard":null,"GuardUp":2,"OffensiveGuard":2,"CriticalDraw":2,"PunishingDraw":2,"QuickSheathe":2,"Slugger":2,"StaminaThief":3,"AffinitySliding":null,"HornMaestro":null,"Artillery":2,"LoadShells":2,"SpecialAmmoBoost":2,"Normal RapidUp":2,"PierceUp":2,"SpreadUp":2,"AmmoUp":2,"ReloadSpeed":null,"RecoilDown":null,"Steadiness":2,"RapidFireUp":null,"DefenseBoost":5,"DivineBlessing":2,"RecoveryUp":2,"RecoverySpeed":3,"SpeedEating":2,"Earplugs":2,"Windproof":3,"TremorResistance":2,"BubblyDance":2,"EvadeWindow":2,"EvadeExtender":2,"FireResistance":3,"WaterResistance":3,"IceResistance":3,"ThunderResistance":3,"DragonResistance":3,"BlightResistance":2,"PoisonResistance":3,"ParalysisResistance":3,"SleepResistance":3,"StunResistance":3,"MuckResistance":null,"BlastResistance":3,"Botanist":3,"Geologist":3,"Partbreaker":2,"CaptureMaster":null,"CarvingMaster":null,"GoodLuck":2,"SpeedSharpening":3,"Bombardier":3,"Mushroomancer":2,"ItemProlonger":3,"Wide-Range":4,"FreeMeal":3,"Heroics":2,"Fortify":null,"FlinchFree":3,"JumpMaster":null,"CarvingPro":null,"HungerResistance":3,"LeapofFaith":null,"Diversion":null,"MasterMounter":null,"ChameleosBlessing":null,"KushalaBlessing":null,"TeostraBlessing":null,"Dragonheart":1,"WirebugWhisperer":2,"WallRunner":3,"Counterstrike":2,"RapidMorph":2,"HellfireCloak":2,"WindAlignment":null,"ThunderAlignment":null,"Stormsoul":null,"BloodRite":null,"Dereliction":null,"Furious":null,"MailofHellfire":null,"Coalescence":2,"Bloodlust":1,"Defiance":3,"SneakAttack":2,"AdrenalineRush":2,"Redirection":2,"SpiribirdsCall":null,"ChargeMaster":2,"Foray":2,"Tune-Up":2,"Grinder S":2,"BladescaleHone":2,"WallRunner Boost":null,"QuickBreath":null,"ElementExploit":2,"Burst":2,"Guts":null,"StatusTrigger":2,"IntrepidHeart":null,"BuildupBoost":null,"Embolden":2,"WindMantle":null,"PowderMantle":null,"Berserk":null,"Strife":null,"Frostcraft":null,"DragonConversion":null,"Heaven-Sent":null,"FrenziedBloodlust":null,"ShockAbsorber":null}}'),{decos:t,lvl4:i,maxLevel:a,qurious:s,pointsPerSlot:n}=e,max=(e,t)=>e>=t?e:t,getMostSkills=(e,t)=>{for(const i of e)if("memo"!==i){for(let e=0;e<4;e++)t.remainingSlots[e]=max(t.remainingSlots[e]||0,i.remainingSlots[e]);for(let e=0;e<5;e++)t.quriousSkills[e]=max(t.quriousSkills[e]||0,i.quriousSkills[e]);for(const[e,a]of Object.entries(i.armorSkills))t.armorSkills[e]=max(t.armorSkills[e]||0,a)}};self.addEventListener("message",(e=>{const t={sets:[],count:{sets:0,combos:0},stats:{quriousSkills:[0,0,0,0,0],armorSkills:{},remainingSlots:[0,0,0,0]}};n.forEach(((t,i)=>{n[i]=Object.entries(t).filter((t=>e.data.skills[t[0]]))}));for(const i of e.data.permutations){e.data.theseArmors=[e.data.armors.helm[i[0]],e.data.armors.chest[i[1]],e.data.armors.arm[i[2]],e.data.armors.waist[i[3]],e.data.armors.leg[i[4]]],e.data.memoBoolean=t.sets.length>=20;const a=testThisBatch(e.data);a&&(getMostSkills(a,t.stats),t.count.combos+=a.length,++t.count.sets,t.sets.length<20&&t.sets.push(a))}postMessage({type:"rerun",final:t}),self.terminate}));const slotDecos=(e,t,i)=>{[0,3,2,1].forEach((a=>{for(const[s,r]of n[a]){if(!t[a])break;if(!e[s])continue;const n=Math.min(t[a],~~(-e[s]/r));n&&(e[s]+=n*r,t[a]-=n,i.push([s,r,"Slot lvl"+(+a+1),n]))}}));const a={};return Object.entries(e).forEach((e=>{const t=~~(s[e[0]]/3);e[1]>=0||!e[0]||(a[t]||(a[t]={total:0}),a[t].total-=e[1],a[t][e[0]]=-e[1])})),a};const findBestSum1=(e,t)=>{for(let i=e.length-1;i>=0;--i)if(+e[i]<=t)return[[+e[i]],+e[i]]},getPoints=e=>{e.fodderSkills.length>0?(e.augs.push({"-Skill":e.fodderSkills[++e.skillsRemovedCount]}),e.quriousPoints+=10):(e.augs.push({"-Def":5}),e.quriousPoints+=5),e.unBloatedPoints=~~(e.quriousPoints/3)},minimumCostForPossibleAugs=(e,t,i)=>{let a=0;for(let s=0;e>0&&s<t.length;++s){const n=Math.min(i[t[s]].total,e);a+=n*+t[s],e-=n}return a},pushAugs=(e,t)=>{if(!t.innateSkills.has(e)){if(5===t.innateSkills.size)return console.log(t.name,e),!0;t.innateSkills.add(e)}t.augs.push({"+Skill":e})};function updateRemainingSkills(e,t){if(0==--e.total)return!0;0==--e[t]&&delete e[t]}function getBestCombos(e,t,i,a,s=0,n={}){switch(e){case 3:return((e,t,i,a=0,s={})=>{let n=[[],0];const r=[0,0];let o,l,c;for(let u=0,d=e.length;0!==u||!n[1];){if(++u>=d){if(n[1])return n;++n[1],u=0}if(o=+e[u],s[o]||0!==t[o].total){a&&(r[0]=(s[o]?1:0)+a);e:for(let g=u;g<d;g++)if(l=+e[g],(o!==l||s[l]||1!==t[l].total)&&!(a&&r[0]<3&&(r[1]=(o===l&&1!==!s[l]?.total||s[l]&&o!==l?1:0)+r[0],r[1]<2)))t:for(let u=g;u<d;u++){if(c=+e[u],o+l+c>i)continue e;if(o+l+c<=n[1])continue;const d=t[c]?.total||0,g=s[c]?.total||0;if(2!==a||o!==l||c!==o||1!==g){switch(d+g){case 1:if(c===o||c===l)continue t;break;case 2:if(c===o&&c===l)continue t}if((!a||3===r[1]||o===l&&l===c||g>1||g&&c!==o&&c!==l)&&(n=[[o,l,c],o+l+c],n[1]===i))return n}}}}return n})(t,i,a,s);case 2:return function(e,t,i,a,s={}){let n=[[],0];for(let r=0,o=e.length;r<o;++r){const l=+e[r];if(!((s[l]?.total||0)+t[l].total<1))for(let c=r;c<o;c++){const r=+e[c];if((l!==r||s[r]||1!==t[r].total)&&(l===r||!a||s[l]||s[r])&&!(l===r&&(!s[r]&&t[r].total<1||1===s[r]?.total&&t[r].total<1||a&&(s[r]?.total||0)+t[r].total<1)||l+r>i||l+r<=n[1]||(n=[[l,r],l+r],n[1]!==i)))return n}}return n}(t,i,a,s);default:return findBestSum1(t,a)}}const findMaxValueNotInRequestedSkills=e=>{const t={};for(const i in e){const a=e[i];let s=0,n="";for(const e in a)"total"!==e&&a[e]>s&&(s=a[e],n=e);s>0&&(t[i]={total:s,skill:n})}return t},getQuriousSkills=(e,t,i,a=!1)=>{let n=0;if(Object.values(e).forEach((e=>n+=e.total)),a&&n>5*a)return;for(const r of i){let i=t[r];if(i.augs=i.startingAugs.map((e=>Object.fromEntries(e))),i.quriousPoints=i.startingQuriousPoints,i.unBloatedPoints=~~(i.quriousPoints/3),i.innateSkills=new Set(Object.keys(i.skills)),Object.keys(e).length&&n>0&&i.augs.length<6){let t,r=6-i.augs.length,o=Math.min(6-i.augs.length,n,a||3),l=r-n;for(;--l>=0||minimumCostForPossibleAugs(o,Object.keys(e),e)>i.unBloatedPoints;)getPoints(i),o=Math.min(6-i.augs.length,n,a||3);const c=5-i.innateSkills.size<o?5-i.innateSkills.size:0;e:if(c){for(let t of i.requestedSkills)if(e[s[t]/3]&&e[s[t]/3][t])for(;c<o&&e[s[t]/3][t]&&i.quriousPoints>s[t];)if(--n,i.quriousPoints-=s[t],i.unBloatedPoints-=s[t]/3,--o,pushAugs(t,i),updateRemainingSkills(e[s[t]/3],t)&&delete e[s[t]/3],c===o)break e;const a=findMaxValueNotInRequestedSkills(e);for(t=getBestCombos(o,Object.keys(a),a,i.unBloatedPoints,c);(!t||t[1]<=1)&&--o>0;)i.unBloatedPoints<5*o&&getPoints(i),t=getBestCombos(o,c<o?Object.keys(a):Object.keys(e),c<o?a:e,i.unBloatedPoints,c<o?c:0);((i.quriousPoints-=3*t[1])<0||isNaN(i.quriousPoints))&&console.log(`${i.name} has ${i.quriousPoints} points}`,i),n-=t[0].length;for(let s of t[0]){let t;if(a[s]?.total>0)--a[s].total,t=a[s].skill;else{if(!(i.innateSkills.size<5)){console.log("augment not found"),++n;continue}{let n=Object.keys(a);if(e[s]?.total>0)t=e[s].skill;else if(n.indexOf(s.toString())-1>=0&&a[n[n.indexOf(s.toString())-1]]?.total>0){let e=n[n.indexOf(s.toString())-1];i.quriousPoints+=3*(s-e),--a[e].total,t=a[e].skill}}}pushAugs(t,i),updateRemainingSkills(e[s],t)&&delete e[s]}}else{if(t=getBestCombos(o,Object.keys(e),e,i.unBloatedPoints),(i.quriousPoints-=3*t[1])<0||isNaN(i.quriousPoints)){console.log(`${i.name} has ${i.quriousPoints} points}`,i);continue}n-=t[0].length;for(const a of t[0]){const t=Object.keys(e[a])[1];pushAugs(t,i),updateRemainingSkills(e[a],t)&&delete e[a]}}}}const replaceAugment=(t,i,a)=>{t.augs.splice(i,1);const s=findBestSum1(a,~~(t.quriousPoints/3));t.quriousPoints-=3*s[1],--n;const r=Object.keys(e[s[0]])[1];pushAugs(r,t),updateRemainingSkills(e[s[0]],r)&&delete e[s[0]]};e:for(const i of t){if(!Object.keys(e).length||!a||!n)break;for(let t=i.augs.length-1;t>=0&&i.quriousPoints>8;t--){let a=i.innateSkills.size<5?Object.keys(e):Object.keys(e).filter((t=>Object.keys(e[t]).some((e=>i.innateSkills.has(e)))));if(!a.length)continue e;i.augs[t]["-Def"]&&i.quriousPoints-5>=3*+a[0]?(i.quriousPoints-=5,replaceAugment(i,t,a)):i.augs[t]["-Skill"]&&i.quriousPoints-10>=3*+a[0]&&(i.quriousPoints-=10,replaceAugment(i,t,a))}}return!Object.keys(e).length},testThisBatch=e=>{const{thisWeapon:n,theseCharms:r,skillInfo:o,theseArmors:l,skills:c}=e;let u=new Map,d=[];const g={};for(const e of l)for(const t of e.requestedSkills)if(g[t]=(g[t]||0)+e.skills[t],g[t]>a[t])return;let h;if(o.charmNeeded)for(let e in o.charmNeeded)if(!(g[e]>=o.charmNeeded[e]||(h=r.filter((t=>(l[e]||0)+(t[e]||0)>=o.charmNeeded[e])),h.length)))return;const S=Object.entries(g),p=[0,0,0,0];[n,l[0].decos,l[1].decos,l[2].decos,l[3].decos,l[4].decos,e.charmSlots].forEach((e=>e.forEach(((e,t)=>p[t]+=e))));const f=[0,1,2,3,4].sort(((e,t)=>l[e].skillLimitation-l[t].skillLimitation));let k=[];for(const n of h||r){if(Object.entries(n).some((e=>(g[e[0]]||0)+e[1]>a[e[0]])))continue;let r="",o={decos:[],augments:{},armorSkills:S,charm:[]};for(let e in n)g[e]&&g[e]+n[e]>a[e]||(r+=`${s[e]}-${t[e]}-${i[e]}-${n[e]}`,o.charm.push([e,n[e]]));if(u.has(r)&&!1===u.get(r))continue;if(e.memoBoolean&&u.has(r)){k.push("memo");continue}let h={};for(const e in c)c[e]+(g[e]||0)+(n[e]||0)<0&&(h[e]=c[e]+(g[e]||0)+(n[e]||0));const m=slotDecos(h,p.slice(0),o.decos);getQuriousSkills(m,l,f)?!0===testSets(o.decos,o.charm,o.armorSkills,l,c,h,m,d,p,o.augments)&&(e.memoBoolean&&u.set(r,!0),k.push({usedSkills:o,armors:[[l[0].name,l[0]],[l[1].name,l[1]],[l[2].name,l[2]],[l[3].name,l[3]],[l[4]?.name,l[4]]],remainingSlots:[0,0,0,0],quriousSkills:findExtraQuriousSkills(l),armorSkills:findExtraArmorSkills(l),decoArr:p})):u.set(r,!1)}if(d.length&&console.log(d),k.length)return k};function testSets(e,t,i,a,s,n,r,o,l,c){let u={};u[t[0][0]]=t[0][1],u[t[1][0]]=t[1][1],e.forEach((([e,t,,i])=>{u[e]=(u[e]||0)+t*i}));for(const e of i)u[e[0]]=(u[e[0]]||0)+e[1];for(let e of a)c[e.name]=[],e.augs.forEach((t=>{c[e.name].push(t),t["+Skill"]&&(u[t["+Skill"]]=(u[t["+Skill"]]||0)+1)}));if(Object.entries(s).every((e=>u[e[0]]+e[1]>=0)))return!0;o.push({skillsNeeded:s,innateArmorSkills:a,charmSkills:t,initalDecos:l,decosRecord:e,skillsNeededAfterDecos:n,skillAugmentsRecorded:c,remainingSkillsListAfterAugment:r,actualSkillsTotal:u})}function findExtraQuriousSkills(e,t=[0,0,0,0,0]){for(const i of e){if(i.quriousPoints<8||i.innateSkills?.size>4)continue;let e=0;const a=5-(i.innateSkills?.size||Object.keys(i.skills).length);let s=1;for(let t in i.augs)"-Def"===t&&++e;let n=6-i.augs.length,r=n>0?0:--e>=0?5:10;for(;(i.quriousPoints-r)/(3*s)>=1&&s<=a;){let a=Math.min(5,~~((i.quriousPoints-r)/(3*s)));for(;--a>=0;)++t[a];n>0&&--n,r+=n>0?0:--e>=0?5:10,++s}}return t}function findExtraArmorSkills(e,t={}){for(const i of e){if(i.quriousPoints<5||!i.fodderCount)continue;let e={};for(let t of i.augs)t["-Skill"]&&(e["-Skill"]=(e["-Skill"]||0)+1);Object.entries(e).forEach((e=>{t[e[0]]=(t[e[0]]||0)+Math.min(e[1],~~(i.quriousPoints/5))}))}return t}})();
//# sourceMappingURL=setBuildWorker.js.map